define("apps/tasks/app",["require","jquery","lodash","monster","chosen","papaparse","toastr"],function(t){var n=t("jquery"),a=t("lodash"),e=t("monster"),l=(t("chosen"),t("papaparse")),o=t("toastr");return{name:"tasks",css:["app"],i18n:{"en-US":{customCss:!1}},requests:{},subscribe:{},appFlags:{summaryJobs:{}},load:function(t){var n=this;n.initApp(function(){t&&t(n)})},initApp:function(t){var n=this;e.pub("auth.initApp",{app:n,callback:t})},render:function(t){var a=this,l=t||{},o=l.hasOwnProperty("container")?l.container:n("#monster_content"),s=n(e.template(a,"app"));a.listPossibleJobs(function(t){a.appFlags.summaryJobs=t,o.empty().append(s),a.renderImports(s)})},prepareReviewData:function(t){var n={data:{isStartingNow:t.isStartingNow,fileName:t.fileName,totalRecords:t.records.length,columns:{actual:t.columns.actual,expected:t.columns.expected},recordsToReview:t.records.slice(0,5),job:t.job}};a.each(n.data.recordsToReview,function(t){delete t.__parsed_extra}),n.data.columns.others=[];var e;return a.each(t.columns.actual,function(l){e=0,a.each(t.columns.expected,function(t){t&&t.indexOf(l)>=0&&e++}),0===e&&n.data.columns.others.indexOf(l)<0&&n.data.columns.others.push(l)}),n},renderReview:function(t){var a=this,l=n("#csv_jobs_container"),o=a.prepareReviewData(t),s=n(e.template(a,"review",o));a.bindReview(s,t),l.find(".content-wrapper").empty().append(s)},bindReview:function(t,n){var l=this,o=n.columns.expected;e.ui.footable(t.find(".footable"),{filtering:{enabled:!1}}),t.find("#proceed").on("click",function(){var s=l.getColumnsMatching(t),i=l.checkValidColumns(s,o);if(i.isValid){var r=l.formatTaskData(s,n);l.addTask(n.isStartingNow,r,function(){l.renderImports()})}else{var c=l.i18n.active().csvJobs.review.errors.title+"<br/><br/>";a.each(i.errors,function(t,n){a.each(t,function(t){c+=t+": "+l.i18n.active().csvJobs.review.errors[n]+"<br/>"})}),e.ui.alert("error",c)}}),t.find("#cancel").on("click",function(){l.renderImports()})},getColumnsMatching:function(t){var a,e={};return t.find(".review-table-wrapper tr.footable-header th.column-data").each(function(){a=n(this),e[a.data("column")]=a.find(".column-selector").val()}),e},formatTaskData:function(t,n){var e,l=[],o={task:{type:n.job.type,action:n.job.action},fileName:n.fileName};return a.each(n.records,function(n){e={},a.each(t,function(t,a){"_none"!==t&&(e[t]=n[a])}),l.push(e)}),o.data=l,o},checkValidColumns:function(t,n){var e={mandatory:{},optional:{}},l=!0,o={missing:[],tooMany:[]};return a.each(n,function(t,n){e[n]={},a.each(t,function(t){e[n][t]=0})}),a.each(t,function(t){e.mandatory.hasOwnProperty(t)&&e.mandatory[t]++,e.optional.hasOwnProperty(t)&&e.optional[t]++}),a.each(e.mandatory,function(t,n){1!==t&&(o[0===t?"missing":"tooMany"].push(n),l=!1)}),a.each(e.optional,function(t,n){t>1&&(o.tooMany.push(n),l=!1)}),{isValid:l,errors:o}},renderUploads:function(){var t=this,a=n("#csv_jobs_container");t.listPossibleJobs(function(l){var o=n(e.template(t,"upload",{jobs:l}));t.bindUploads(o,l),a.find(".content-wrapper").empty().append(o)})},bindUploads:function(t,a){var o,s=this,i=function(t){o=t.target.files[0],u(o)},r=function(){var n=t.find("#job_selector option:selected");return{type:n.parents("optgroup").data("category"),action:n.val()}},c=function(t,n){var e={mandatory:[],optional:[]};return a.hasOwnProperty(t)&&a[t].hasOwnProperty(n)&&(e.mandatory=a[t][n].mandatory,e.optional=a[t][n].optional),e},u=function(n){if(n.name.match(".+(.csv)$"))t.find(".file-name").text(n.name),t.find(".selected-file").show(),t.find(".upload-frame").hide(),"none"!==t.find("#job_selector").val()&&t.find(".start-job-action").removeAttr("disabled");else{var a=e.template(s,"!"+s.i18n.active().csvJobs.uploads.errors.wrongType,{type:n.type});e.ui.alert("error",a),d()}},d=function(){o=void 0,t.find(".start-job-action").attr("disabled","disabled")},p=function(n){var e=t.find("#job_selector"),i=e.find("option:selected").parents("optgroup").data("category"),u=e.val(),d=a[i][u];if(d.hasOwnProperty("expected_content")&&"text/csv"===d.expected_content)o&&l.parse(o,{header:!0,skipEmptyLines:!0,complete:function(t){var a=r(),e=c(a.type,a.action),l={isStartingNow:n,fileName:o.name,records:t.data,columns:{expected:{mandatory:e.mandatory,optional:e.optional},actual:t.meta.fields},job:a};s.renderReview(l)}});else{var p={task:{type:i,action:u}};s.addTask(n,p,function(){s.renderImports()})}};t.find("#upload_csv_file").change(i),t.find("#start").on("click",function(){p(!0)}),t.find("#create").on("click",function(){p(!1)}),t.find("#back_to_listing").on("click",function(){s.renderImports()}),t.find(".text-upload").on("click",function(){t.find("#upload_csv_file").trigger("click")}),t.find(".undo-upload").on("click",function(n){t.find(".file-name").text(""),t.find(".selected-file").hide(),t.find(".upload-frame").show(),d(),n.stopPropagation()}),t.find("#job_selector").chosen({search_contains:!0,width:"220px",placeholder_text_single:s.i18n.active().csvJobs.uploads.selectJob}),t.find("#job_selector").on("change",function(e){var l=n(this),s=l.val(),i=l.find("option:selected").parents("optgroup").data("category"),r=t.find(".help-selection"),c=a[i][s],u=function(t){return(t||[]).length?t.join(", "):"-"},d=c.hasOwnProperty("expected_content")&&"text/csv"===c.expected_content;r.show(),r.find(".description .content").text(c.description),r.find(".required-columns .content").text(u(c.mandatory)),r.find(".optional-columns .content").text(u(c.optional)),r.find(".doc-section .content").html(c.doc),d?o?(t.find(".upload-frame").hide(),t.find(".selected-file").show(),t.find(".start-job-action").removeAttr("disabled")):(t.find(".upload-frame").show(),t.find(".selected-file").hide(),t.find(".start-job-action").attr("disabled","disabled")):(t.find(".upload-frame").hide(),t.find(".selected-file").hide(),t.find(".start-job-action").removeAttr("disabled"))});var m=t.find(".upload-frame").get(0);m.ondragover=function(n){return t.find(".upload-frame").addClass("hover"),!1},m.ondragleave=function(n){return t.find(".upload-frame").removeClass("hover"),!1},m.ondrop=function(n){return t.find(".upload-frame").removeClass("hover"),n.preventDefault(),o=n.dataTransfer.files[0],u(o),!1}},renderImports:function(t){var a=this,l=t||n("#csv_jobs_container");l.find(".content-wrapper").empty(),a.listImportJobs(function(t){var o=a.formatImportData(t),s=n(e.template(a,"imports",o));a.bindImports(s),e.ui.tooltips(s,{options:{container:"body"}}),l.find(".content-wrapper").empty().append(s)})},bindImports:function(t){var a=this;e.ui.footable(t.find(".footable"),{filtering:{enabled:!1}}),t.find("#start_new_job").on("click",function(){a.renderUploads()}),t.find("#refresh").on("click",function(){a.renderImports()}),t.find(".imports-table").on("click",".download-job-output",function(){var t=n(this).parents(".job-row").data("job-id");window.open(a.apiUrl+"accounts/"+a.accountId+"/tasks/"+t+"/output?auth_token="+a.getAuthToken(),"_blank")}),t.find(".imports-table").on("click",".preview-job-output",function(){var t=n(this).parents(".job-row").data("job-id");a.downloadTaskOutput(t,function(t){a.showCSVPopup(t)})}),t.find(".imports-table").on("click",".start-job",function(){var t=n(this),e=t.parents(".job-row").data("job-id");t.tooltip("hide"),a.startTask(e,function(){a.renderImports()})}),t.find(".imports-table").on("click",".stop-job",function(){var t=n(this),e=t.parents(".job-row").data("job-id");t.tooltip("hide"),a.stopTask(e,function(){a.renderImports()},function(){o.warning(a.i18n.active().csvJobs.imports.taskAlreadyDone),a.renderImports()})}),t.find(".imports-table").on("click",".remove-job",function(){var t=n(this),e=t.parents(".job-row").data("job-id");t.tooltip("hide"),a.deleteTask(e,function(){a.renderImports()})}),t.find(".imports-table").on("click",".download-job-input",function(){var t=n(this).parents(".job-row").data("job-id");window.open(a.apiUrl+"accounts/"+a.accountId+"/tasks/"+t+"/input?auth_token="+a.getAuthToken(),"_blank")}),t.find(".imports-table").on("click",".preview-job-input",function(){var t=n(this).parents(".job-row").data("job-id");a.downloadTaskInput(t,function(t){a.showCSVPopup(t)})})},showCSVPopup:function(t){var o=this;l.parse(t,{header:!0,skipEmptyLines:!0,complete:function(t){var l=a.map(t.meta.fields,function(t){return t.replace("."," > ")}),s={columns:l,records:t.data},i=n(e.template(o,"dialog-csv",s));e.ui.footable(i.find(".footable"),{paging:{size:5}}),e.ui.dialog(i,{title:o.i18n.active().csvJobs.imports.previewPopup.title})}})},formatImportData:function(t){var n,e=this,l={jobs:[]},o={internal_error:"failed",failure:"failed",executing:"running",success:"success",pending:"pending",partial:"partial"},s=["internal_error","failure","partial","success","stopped"];return a.each(t,function(t){var a=e.appFlags.summaryJobs.hasOwnProperty(t.category)&&e.appFlags.summaryJobs[t.category].hasOwnProperty(t.action)?e.appFlags.summaryJobs[t.category][t.action]:{},i=a.hasOwnProperty("expected_content")&&"text/csv"===a.expected_content;n={id:t.id,status:o.hasOwnProperty(t.status)?o[t.status]:t.status,category:t.category,action:t.action,records:{total:t.hasOwnProperty("total_count")?t.total_count:parseInt(t.failure_count||0)+parseInt(t.success_count||0),imported:i&&t.hasOwnProperty("success_count")?t.success_count:"--",rejected:i&&t.hasOwnProperty("failure_count")?t.failure_count:"--"},timestamp:t.created,hasInput:i,fileName:t.file_name,isDone:s.indexOf(t.status)>=0},l.jobs.push(n)}),l},listImportJobs:function(t){var n=this;n.callApi({resource:"tasks.list",data:{accountId:n.accountId},success:function(n){t&&t(n.data)}})},addTask:function(t,n,a){var e=this;e.createTask(n,function(n){t?e.startTask(n._read_only.id,a):a&&a()})},createTask:function(t,n){var a=this,e={};t.data&&(e.records=t.data),t.fileName&&(e.file_name=t.fileName),a.callApi({resource:"tasks.add",data:{accountId:a.accountId,category:t.task.type,action:t.task.action,data:e},success:function(t){n&&n(t.data)}})},startTask:function(t,n){var a=this;a.callApi({resource:"tasks.start",data:{accountId:a.accountId,taskId:t},success:function(t){n&&n(t.data)}})},stopTask:function(t,n,a){var e=this;e.callApi({resource:"tasks.stop",data:{accountId:e.accountId,taskId:t,generateError:!1},success:function(t){n&&n(t.data)},error:function(t,n,e){404===n.status&&"task is not running"===t.data.reason?a():e(t)}})},deleteTask:function(t,n){var a=this;a.callApi({resource:"tasks.delete",data:{accountId:a.accountId,taskId:t},success:function(t){n&&n(t.data)}})},listPossibleJobs:function(t){var n=this;a.isEmpty(n.appFlags.summaryJobs)?n.callApi({resource:"tasks.summary",data:{accountId:n.accountId},success:function(n){t&&t(n.data.tasks)}}):t&&t(n.appFlags.summaryJobs)},downloadTaskOutput:function(t,n){var a=this;a.callApi({resource:"tasks.getOutput",data:{accountId:a.accountId,taskId:t},success:function(t){n&&n(t)}})},downloadTaskInput:function(t,n){var a=this;a.callApi({resource:"tasks.getInput",data:{accountId:a.accountId,taskId:t},success:function(t){n&&n(t)}})}}}),this.monster=this.monster||{},this.monster.cache=this.monster.cache||{},this.monster.cache.templates=this.monster.cache.templates||{},this.monster.cache.templates.tasks=this.monster.cache.templates.tasks||{},this.monster.cache.templates.tasks._main=this.monster.cache.templates.tasks._main||{},this.monster.cache.templates.tasks._main.app=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(t,n,a,e,l){return'<div id="csv_jobs_container">\n\t<div class="content-wrapper">\n\n\t</div>\n</div>'},useData:!0}),this.monster.cache.templates.tasks._main["dialog-csv"]=Handlebars.template({1:function(t,n,a,e,l){var o=t.lambda,s=t.escapeExpression;return'\t\t\t\t\t\t<th class="column-data" data-sortable="false" data-type="html" data-column="'+s(o(n,n))+'">\n\t\t\t\t\t\t\t'+s(o(n,n))+"\n\t\t\t\t\t\t</th>\n"},3:function(t,n,a,e,l){var o;return"\t\t\t\t\t<tr>\n"+(null!=(o=a.each.call(null!=n?n:t.nullContext||{},n,{name:"each",hash:{},fn:t.program(4,l,0),inverse:t.noop,data:l}))?o:"")+"\t\t\t\t\t</tr>\n"},4:function(t,n,a,e,l){var o,s;return'\t\t\t\t\t\t<td data-breakpoints="xs" data-column="'+t.escapeExpression((s=null!=(s=a.key||l&&l.key)?s:a.helperMissing,"function"==typeof s?s.call(null!=n?n:t.nullContext||{},{name:"key",hash:{},data:l}):s))+'">\n\t\t\t\t\t\t\t'+(null!=(o=t.lambda(n,n))?o:"")+"\n\t\t\t\t\t\t</td>\n"},compiler:[7,">= 4.0.0"],main:function(t,n,a,e,l){var o,s=null!=n?n:t.nullContext||{};return'<div class="csv-wrapper-dialog">\n\t\x3c!-- when opening new dialog, jquery focuses first text field... which happens to be the search field from the table, which is usually all the way to the right\n\tif we have a table that overflows, it means the div will be scrolled all the way to the right when opening it. This is an issue, so we add a hidden field that will catch the automatic focus \n\tnot super clean, but the other solutions aren\'t great --\x3e\n\t<span class="ui-helper-hidden-accessible"><input type="text"/></span>\n\n\t<div class="preview-table-wrapper">\n\t\t<table id="tasks_dialog_csv" class="monster-table footable">\n\t\t\t<thead>\n\t\t\t\t<tr class="footable-header">\n'+(null!=(o=a.each.call(s,null!=n?n.columns:n,{name:"each",hash:{},fn:t.program(1,l,0),inverse:t.noop,data:l}))?o:"")+"\t\t\t\t</tr>\n\t\t\t</thead>\n\n\t\t\t<tbody>\n"+(null!=(o=a.each.call(s,null!=n?n.records:n,{name:"each",hash:{},fn:t.program(3,l,0),inverse:t.noop,data:l}))?o:"")+"\t\t\t</tbody>\n\t\t</table>\n\t</div>\n</div>"},useData:!0}),this.monster.cache.templates.tasks._main.imports=Handlebars.template({1:function(t,n,a,e,l){var o,s,i=null!=n?n:t.nullContext||{},r=a.helperMissing,c=t.escapeExpression,u=t.lambda;return'\t\t\t\t<tr class="job-row" data-job-id="'+c((s=null!=(s=a.id||(null!=n?n.id:n))?s:r,"function"==typeof s?s.call(i,{name:"id",hash:{},data:l}):s))+'" data-status="'+c((s=null!=(s=a.status||(null!=n?n.status:n))?s:r,"function"==typeof s?s.call(i,{name:"status",hash:{},data:l}):s))+'">\n\t\t\t\t\t<td class="status" data-status="'+c((s=null!=(s=a.status||(null!=n?n.status:n))?s:r,"function"==typeof s?s.call(i,{name:"status",hash:{},data:l}):s))+'" data-filter-value="'+c((a.tryI18n||n&&n.tryI18n||r).call(i,(o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.imports)&&o.statuses,null!=n?n.status:n,{name:"tryI18n",hash:{},data:l}))+'">\n'+(null!=(o=(a.compare||n&&n.compare||r).call(i,null!=n?n.status:n,"===","success",{name:"compare",hash:{},fn:t.program(2,l,0),inverse:t.program(4,l,0),data:l}))?o:"")+"\n\t\t\t\t\t\t"+c((a.tryI18n||n&&n.tryI18n||r).call(i,(o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.imports)&&o.statuses,null!=n?n.status:n,{name:"tryI18n",hash:{},data:l}))+"\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>"+c((a.tryI18n||n&&n.tryI18n||r).call(i,(o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.common)&&o.jobKeys,null!=n?n.category:n,{name:"tryI18n",hash:{},data:l}))+" - "+c((a.tryI18n||n&&n.tryI18n||r).call(i,(o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.common)&&o.jobKeys,null!=n?n.action:n,{name:"tryI18n",hash:{},data:l}))+"</td>\n\t\t\t\t\t<td>"+c(u(null!=(o=null!=n?n.records:n)?o.total:o,n))+"</td>\n\t\t\t\t\t<td>"+c(u(null!=(o=null!=n?n.records:n)?o.imported:o,n))+"</td>\n\t\t\t\t\t<td>"+c(u(null!=(o=null!=n?n.records:n)?o.rejected:o,n))+'</td>\n\t\t\t\t\t<td data-sort-value="'+c((s=null!=(s=a.timestamp||(null!=n?n.timestamp:n))?s:r,"function"==typeof s?s.call(i,{name:"timestamp",hash:{},data:l}):s))+'">'+c((a.toFriendlyDate||n&&n.toFriendlyDate||r).call(i,null!=n?n.timestamp:n,{name:"toFriendlyDate",hash:{},data:l}))+"</td>\n\t\t\t\t\t<td>\n"+(null!=(o=a.if.call(i,null!=n?n.hasInput:n,{name:"if",hash:{},fn:t.program(15,l,0),inverse:t.program(17,l,0),data:l}))?o:"")+"\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t\n"+(null!=(o=(a.compare||n&&n.compare||r).call(i,null!=n?n.status:n,"===","pending",{name:"compare",hash:{},fn:t.program(19,l,0),inverse:t.program(21,l,0),data:l}))?o:"")+"\t\t\t\t\t</td>\n\t\t\t\t</tr>\n"},2:function(t,n,a,e,l){return'\t\t\t\t\t\t\t<i class="icon-telicon-check-circle"></i>\n'},4:function(t,n,a,e,l){var o;return null!=(o=(a.compare||n&&n.compare||a.helperMissing).call(null!=n?n:t.nullContext||{},null!=n?n.status:n,"===","partial",{name:"compare",hash:{},fn:t.program(5,l,0),inverse:t.program(7,l,0),data:l}))?o:""},5:function(t,n,a,e,l){return'\t\t\t\t\t\t\t\t<i class="fa fa-warning"></i>\n'},7:function(t,n,a,e,l){var o;return null!=(o=(a.compare||n&&n.compare||a.helperMissing).call(null!=n?n:t.nullContext||{},null!=n?n.status:n,"===","failed",{name:"compare",hash:{},fn:t.program(8,l,0),inverse:t.program(10,l,0),data:l}))?o:""},8:function(t,n,a,e,l){return'\t\t\t\t\t\t\t\t\t<i class="icon-telicon-x-circled"></i>\n'},10:function(t,n,a,e,l){var o;return(null!=(o=(a.compare||n&&n.compare||a.helperMissing).call(null!=n?n:t.nullContext||{},null!=n?n.status:n,"===","stopped",{name:"compare",hash:{},fn:t.program(11,l,0),inverse:t.program(13,l,0),data:l}))?o:"")+"\t\t\t\t\t\t\t\t\t\n"},11:function(t,n,a,e,l){return'\t\t\t\t\t\t\t\t\t\t<i class="fa fa-stop"></i>\n'},13:function(t,n,a,e,l){return'\t\t\t\t\t\t\t\t\t\t<i class="fa fa-spin fa-spinner"></i>\n'},15:function(t,n,a,e,l){var o,s,i=t.escapeExpression,r=t.lambda;return'\t\t\t\t\t\t\t<div class="file-name">\n\t\t\t\t\t\t\t\t'+i((s=null!=(s=a.fileName||(null!=n?n.fileName:n))?s:a.helperMissing,"function"==typeof s?s.call(null!=n?n:t.nullContext||{},{name:"fileName",hash:{},data:l}):s))+'\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="actions">\n\t\t\t\t\t\t\t\t<i class="job-action preview-job-input fa fa-search-plus" data-toggle="tooltip" data-placement="top" data-original-title="'+i(r((o=(o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.imports)&&o.tooltips)&&o.previewInput,n))+'"></i>\n\t\t\t\t\t\t\t\t<i class="job-action download-job-input fa fa-cloud-download" data-toggle="tooltip" data-placement="top" data-original-title="'+i(r((o=(o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.imports)&&o.tooltips)&&o.downloadInput,n))+'"></i>\n\t\t\t\t\t\t\t</div>\n'},17:function(t,n,a,e,l){var o;return"\t\t\t\t\t\t\t"+t.escapeExpression(t.lambda((o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.imports)&&o.noInput,n))+"\n"},19:function(t,n,a,e,l){var o,s=t.lambda,i=t.escapeExpression;return'\t\t\t\t\t\t\t<i class="job-action start-job fa fa-play" data-toggle="tooltip" data-placement="top" data-original-title="'+i(s((o=(o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.imports)&&o.tooltips)&&o.start,n))+'"></i>\n\t\t\t\t\t\t\t<i class="job-action remove-job fa fa-remove" data-toggle="tooltip" data-placement="top" data-original-title="'+i(s((o=(o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.imports)&&o.tooltips)&&o.remove,n))+'"></i>\n'},21:function(t,n,a,e,l){var o;return null!=(o=(a.compare||n&&n.compare||a.helperMissing).call(null!=n?n:t.nullContext||{},null!=n?n.status:n,"===","running",{name:"compare",hash:{},fn:t.program(22,l,0),inverse:t.program(24,l,0),data:l}))?o:""},22:function(t,n,a,e,l){var o;return'\t\t\t\t\t\t\t\t<i class="job-action stop-job fa fa-stop" data-toggle="tooltip" data-placement="top" data-original-title="'+t.escapeExpression(t.lambda((o=(o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.imports)&&o.tooltips)&&o.stop,n))+'"></i>\n'},24:function(t,n,a,e,l){var o;return null!=(o=a.if.call(null!=n?n:t.nullContext||{},null!=n?n.isDone:n,{name:"if",hash:{},fn:t.program(25,l,0),inverse:t.program(27,l,0),data:l}))?o:""},25:function(t,n,a,e,l){var o,s=t.lambda,i=t.escapeExpression;return'\t\t\t\t\t\t\t\t\t<i class="job-action preview-job-output fa fa-search-plus" data-toggle="tooltip" data-placement="top" data-original-title="'+i(s((o=(o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.imports)&&o.tooltips)&&o.previewOutput,n))+'"></i>\n\t\t\t\t\t\t\t\t\t<i class="job-action download-job-output fa fa-cloud-download" data-toggle="tooltip" data-placement="top" data-original-title="'+i(s((o=(o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.imports)&&o.tooltips)&&o.downloadOutput,n))+'"></i>\n'},27:function(t,n,a,e,l){var o;return"\t\t\t\t\t\t\t\t\t"+t.escapeExpression(t.lambda((o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.imports)&&o.noOutput,n))+"\n"},compiler:[7,">= 4.0.0"],main:function(t,n,a,e,l){var o,s=t.lambda,i=t.escapeExpression;return'<div id="imports">\n\t<div class="app-title">'+i(s(null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.imports:o)?o.title:o,n))+'</div>\n\n\t<div class="actions">\n\t\t<button id="start_new_job" class="monster-button-primary"><i class="fa fa-plus"></i>'+i(s(null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.imports:o)?o.startNew:o,n))+'</button>\n\t\t<button id="refresh" class="monster-button"><i class="fa fa-refresh"></i>'+i(s(null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.imports:o)?o.refresh:o,n))+'</button>\n\t</div>\n\n\t<div class="table-wrapper">\n\t\t<table id="tasks_imports_table" class="imports-table monster-table footable">\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th data-type="html">'+i(s(null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.imports:o)?o.table:o)?o.columns:o)?o.status:o,n))+"</th>\n\t\t\t\t\t<th>"+i(s(null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.imports:o)?o.table:o)?o.columns:o)?o.type:o,n))+"</th>\n\t\t\t\t\t<th>"+i(s(null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.imports:o)?o.table:o)?o.columns:o)?o.total:o,n))+"</th>\n\t\t\t\t\t<th>"+i(s(null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.imports:o)?o.table:o)?o.columns:o)?o.imported:o,n))+'</th>\n\t\t\t\t\t<th data-breakpoints="xs">'+i(s(null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.imports:o)?o.table:o)?o.columns:o)?o.rejected:o,n))+'</th>\n\t\t\t\t\t<th data-sorted="true" data-direction="DESC">'+i(s(null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.imports:o)?o.table:o)?o.columns:o)?o.timestamp:o,n))+'</th>\n\t\t\t\t\t<th data-type="html" data-filterable="false" data-sortable="false">'+i(s(null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.imports:o)?o.table:o)?o.columns:o)?o.input:o,n))+'</th>\n\t\t\t\t\t<th data-type="html" data-filterable="false" data-sortable="false">'+i(s(null!=(o=null!=(o=null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.imports:o)?o.table:o)?o.columns:o)?o.actions:o,n))+"</th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody>\n"+(null!=(o=a.each.call(null!=n?n:t.nullContext||{},null!=n?n.jobs:n,{name:"each",hash:{},fn:t.program(1,l,0),inverse:t.noop,data:l}))?o:"")+"\n\t\t\t</tbody>\n\t\t</table>\n\t</div>\n</div>"},useData:!0}),this.monster.cache.templates.tasks._main.review=Handlebars.template({1:function(t,n,a,e,l,o,s){var i,r=t.lambda,c=t.escapeExpression,u=null!=n?n:t.nullContext||{};return'\t\t\t\t\t\t<th class="column-data" data-sortable="false" data-type="html" data-column="'+c(r(n,n))+'">\n\t\t\t\t\t\t\t<div>'+c(r(n,n))+'</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\x3c!-- we don\'t use the #select helper because we don\'t want to select the values from others, so we do the selected manually --\x3e\n\t\t\t\t\t\t\t\t<select class="column-selector">\n\t\t\t\t\t\t\t\t\t<option value="_none">-</option>\n'+(null!=(i=a.each.call(u,(i=(i=(i=l&&l.root)&&i.data)&&i.columns)&&i.expected,{name:"each",hash:{},fn:t.program(2,l,0,o,s),inverse:t.noop,data:l}))?i:"")+'\t\t\t\t\t\t\t\t\t<optgroup label="'+c(r((i=(i=(i=(i=(i=l&&l.root)&&i.i18n)&&i.csvJobs)&&i.review)&&i.columns)&&i.others,n))+'">\n'+(null!=(i=a.each.call(u,(i=(i=(i=l&&l.root)&&i.data)&&i.columns)&&i.others,{name:"each",hash:{},fn:t.program(6,l,0,o,s),inverse:t.noop,data:l}))?i:"")+"\t\t\t\t\t\t\t\t\t</optgroup>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</th>\n"},2:function(t,n,a,e,l,o,s){var i,r,c=null!=n?n:t.nullContext||{},u=a.helperMissing,d=t.escapeExpression;return'\t\t\t\t\t\t\t\t\t\t<optgroup data-category="'+d((r=null!=(r=a.key||l&&l.key)?r:u,"function"==typeof r?r.call(c,{name:"key",hash:{},data:l}):r))+'" label="'+d((a.tryI18n||n&&n.tryI18n||u).call(c,(i=(i=(i=(i=l&&l.root)&&i.i18n)&&i.csvJobs)&&i.review)&&i.columns,l&&l.key,{name:"tryI18n",hash:{},data:l}))+'">\n'+(null!=(i=a.each.call(c,n,{name:"each",hash:{},fn:t.program(3,l,0,o,s),inverse:t.noop,data:l}))?i:"")+"\t\t\t\t\t\t\t\t\t\t</optgroup>\n"},3:function(t,n,a,e,l,o,s){var i,r=t.escapeExpression,c=null!=n?n:t.nullContext||{},u=a.helperMissing;return'\t\t\t\t\t\t\t\t\t\t\t\t<option value="'+r(t.lambda(n,n))+'"'+(null!=(i=(a.compare||n&&n.compare||u).call(c,n,"===",s[2],{name:"compare",hash:{},fn:t.program(4,l,0,o,s),inverse:t.noop,data:l}))?i:"")+">"+r((a.tryI18n||n&&n.tryI18n||u).call(c,(i=(i=(i=(i=l&&l.root)&&i.i18n)&&i.csvJobs)&&i.review)&&i.columns,n,{name:"tryI18n",hash:{},data:l}))+"</option>\n"},4:function(t,n,a,e,l){return" selected"},6:function(t,n,a,e,l){var o=t.lambda,s=t.escapeExpression;return'\t\t\t\t\t\t\t\t\t\t\t<option value="opaque.'+s(o(n,n))+'">'+s(o(n,n))+"</option>\n"},8:function(t,n,a,e,l){var o;return"\t\t\t\t\t<tr>\n"+(null!=(o=a.each.call(null!=n?n:t.nullContext||{},n,{name:"each",hash:{},fn:t.program(9,l,0),inverse:t.noop,data:l}))?o:"")+"\t\t\t\t\t</tr>\n"},9:function(t,n,a,e,l){var o,s;return'\t\t\t\t\t\t<td data-breakpoints="xs" data-column="'+t.escapeExpression((s=null!=(s=a.key||l&&l.key)?s:a.helperMissing,"function"==typeof s?s.call(null!=n?n:t.nullContext||{},{name:"key",hash:{},data:l}):s))+'">\n\t\t\t\t\t\t\t'+(null!=(o=t.lambda(n,n))?o:"")+"\n\t\t\t\t\t\t</td>\n"},compiler:[7,">= 4.0.0"],main:function(t,n,a,e,l,o,s){var i,r=t.lambda,c=t.escapeExpression,u=null!=n?n:t.nullContext||{},d=a.helperMissing;return'<div id="review">\n\t<div class="app-title">'+c(r(null!=(i=null!=(i=null!=(i=null!=n?n.i18n:n)?i.csvJobs:i)?i.review:i)?i.title:i,n))+'</div>\n\n\t<div class="headline">\n\t\t<div>'+c(r(null!=(i=null!=(i=null!=(i=null!=(i=null!=n?n.i18n:n)?i.csvJobs:i)?i.review:i)?i.headline:i)?i.fourth:i,n))+' <span class="highlight">'+c((a.tryI18n||n&&n.tryI18n||d).call(u,(i=(i=(i=(i=l&&l.root)&&i.i18n)&&i.csvJobs)&&i.common)&&i.jobKeys,null!=(i=null!=(i=null!=n?n.data:n)?i.job:i)?i.type:i,{name:"tryI18n",hash:{},data:l}))+" - "+c((a.tryI18n||n&&n.tryI18n||d).call(u,(i=(i=(i=(i=l&&l.root)&&i.i18n)&&i.csvJobs)&&i.common)&&i.jobKeys,null!=(i=null!=(i=null!=n?n.data:n)?i.job:i)?i.action:i,{name:"tryI18n",hash:{},data:l}))+"</span></div>\n\t\t<div>"+c(r(null!=(i=null!=(i=null!=(i=null!=(i=null!=n?n.i18n:n)?i.csvJobs:i)?i.review:i)?i.headline:i)?i.first:i,n))+' <span class="highlight">'+c(r(null!=(i=null!=n?n.data:n)?i.fileName:i,n))+"</span></div>\n\t\t<div>"+c(r(null!=(i=null!=(i=null!=(i=null!=(i=null!=n?n.i18n:n)?i.csvJobs:i)?i.review:i)?i.headline:i)?i.second:i,n))+' <span class="highlight">'+c(r(null!=(i=null!=n?n.data:n)?i.totalRecords:i,n))+"</span></div>\n\t\t<div> "+c(r(null!=(i=null!=(i=null!=(i=null!=(i=null!=n?n.i18n:n)?i.csvJobs:i)?i.review:i)?i.headline:i)?i.third:i,n))+' </div>\n\t</div>\n\n\t<div class="review-table-wrapper">\n\t\t<table id="tasks_review_table" class="monster-table footable">\n\t\t\t<thead>\n\t\t\t\t<tr class="footable-header">\n'+(null!=(i=a.each.call(u,null!=(i=null!=(i=null!=n?n.data:n)?i.columns:i)?i.actual:i,{name:"each",hash:{},fn:t.program(1,l,0,o,s),inverse:t.noop,data:l}))?i:"")+"\t\t\t\t</tr>\n\t\t\t</thead>\n\n\t\t\t<tbody>\n"+(null!=(i=a.each.call(u,null!=(i=null!=n?n.data:n)?i.recordsToReview:i,{name:"each",hash:{},fn:t.program(8,l,0,o,s),inverse:t.noop,data:l}))?i:"")+'\t\t\t</tbody>\n\t\t</table>\n\t</div>\n\n\t<div class="actions">\n\t\t<button id="cancel" class="monster-button">'+c(r(null!=(i=null!=n?n.i18n:n)?i.cancel:i,n))+'</button>\n\t\t<button id="proceed" class="monster-button-success">'+c(r(null!=(i=null!=(i=null!=(i=null!=n?n.i18n:n)?i.csvJobs:i)?i.review:i)?i.proceed:i,n))+"</button>\n\t</div>\n</div>"},useData:!0,useDepths:!0}),this.monster.cache.templates.tasks._main.upload=Handlebars.template({1:function(t,n,a,e,l){var o,s,i=null!=n?n:t.nullContext||{},r=a.helperMissing,c=t.escapeExpression;return'\t\t\t\t<optgroup data-category="'+c((s=null!=(s=a.key||l&&l.key)?s:r,"function"==typeof s?s.call(i,{name:"key",hash:{},data:l}):s))+'" label="'+c((a.tryI18n||n&&n.tryI18n||r).call(i,(o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.common)&&o.jobKeys,l&&l.key,{name:"tryI18n",hash:{},data:l}))+'">\n'+(null!=(o=a.each.call(i,n,{name:"each",hash:{},fn:t.program(2,l,0),inverse:t.noop,data:l}))?o:"")+"\t\t\t\t</optgroup>\n"},2:function(t,n,a,e,l){var o,s,i=null!=n?n:t.nullContext||{},r=a.helperMissing,c=t.escapeExpression;return'\t\t\t\t\t\t<option value="'+c((s=null!=(s=a.key||l&&l.key)?s:r,"function"==typeof s?s.call(i,{name:"key",hash:{},data:l}):s))+'">'+c((a.tryI18n||n&&n.tryI18n||r).call(i,(o=(o=(o=(o=l&&l.root)&&o.i18n)&&o.csvJobs)&&o.common)&&o.jobKeys,l&&l.key,{name:"tryI18n",hash:{},data:l}))+"</option>\n"},compiler:[7,">= 4.0.0"],main:function(t,n,a,e,l){var o,s=t.lambda,i=t.escapeExpression;return'<div id="uploads">\n\t<div class="app-title">'+i(s(null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.uploads:o)?o.title:o,n))+'</div>\n\n\t<div class="select-job">\n\t\t<select id="job_selector">\n\t\t\t<option value="none"></option>\n'+(null!=(o=a.each.call(null!=n?n:t.nullContext||{},null!=n?n.jobs:n,{name:"each",hash:{},fn:t.program(1,l,0),inverse:t.noop,data:l}))?o:"")+'\t\t</select>\n\n\t\t<div class="help-selection">\n\t\t\t<div class="description">\n\t\t\t\t<span class="title">'+i(s(null!=(o=null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.uploads:o)?o.helpSelection:o)?o.description:o,n))+'</span>\n\t\t\t\t<span class="content"></span>\n\t\t\t</div>\n\n\t\t\t<div class="columns">\n\t\t\t\t<div class="required-columns">\n\t\t\t\t\t<span class="title">'+i(s(null!=(o=null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.uploads:o)?o.helpSelection:o)?o.requiredColumns:o,n))+'</span>\n\t\t\t\t\t<span class="content"></span>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="optional-columns">\n\t\t\t\t\t<span class="title">'+i(s(null!=(o=null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.uploads:o)?o.helpSelection:o)?o.optionalColumns:o,n))+'</span>\n\t\t\t\t\t<span class="content"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="doc-section">\n\t\t\t\t<span class="title">'+i(s(null!=(o=null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.uploads:o)?o.helpSelection:o)?o.doc:o,n))+'</span>\n\t\t\t\t<span class="content"></span>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n\n\t<div class="upload-frame">\n\t\t<i class="fa fa-upload"></i>\n\n\t\t<div class="text-upload">\n\t\t\t<a href="javascript:void(0);">'+i(s(null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.uploads:o)?o.text:o,n))+'</a>\n\t\t</div>\n\n\t\t<input id="upload_csv_file" type="file">\n\t</div>\n\n\t<div class="selected-file">\n\t\t<i class="fa fa-check monster-green"></i>\n\n\t\t<div class="text-upload">\n\t\t\t<div class="first-line">'+i(s(null!=(o=null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.uploads:o)?o.success:o)?o.headline:o,n))+'</div>\n\t\t\t<div class="second-line">'+i(s(null!=(o=null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.uploads:o)?o.success:o)?o.subline:o,n))+' <span class="file-name"></span><a href="javascript:void(0);" class="undo-upload">'+i(s(null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.uploads:o)?o.undo:o,n))+'</a></div>\n\t\t</div>\n\t</div>\n\n\t<div class="actions">\n\t\t<button id="back_to_listing" class="monster-button">'+i(s(null!=(o=null!=n?n.i18n:n)?o.cancel:o,n))+'</button>\n\t\t<button disabled id="create" class="start-job-action monster-button-secondary">'+i(s(null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.uploads:o)?o.create:o,n))+'</button>\n\t\t<button disabled id="start" class="start-job-action monster-button-primary">'+i(s(null!=(o=null!=(o=null!=(o=null!=n?n.i18n:n)?o.csvJobs:o)?o.uploads:o)?o.start:o,n))+"</button>\n\t</div>\n</div>"},useData:!0});