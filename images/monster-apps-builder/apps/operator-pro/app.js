define("apps/operator-pro/app",["require","jquery","lodash","monster","toastr"],function(t){var e=t("jquery"),n=t("lodash"),a=t("monster"),i=t("toastr");return{name:"operator",css:["app"],i18n:{"en-US":{customCss:!1},"fr-FR":{customCss:!1}},hasConfigFile:!0,requests:{},subscribe:{"operator.paintCall":"renderCallElement"},appFlags:{devices:{},users:{}},load:function(t){var e=this;e.initApp(function(){t&&t(e)})},initApp:function(t){var e=this;a.pub("auth.initApp",{app:e,callback:t})},initWebSocket:function(t){var e=this,n=function(t){var e=t.split("_");return e.forEach(function(t,e,n){n[e]=t.charAt(0)+t.slice(1).toLowerCase()}),"on"+e.join("")},a=function(t){var e=t.hasOwnProperty("custom_channel_vars")&&t.custom_channel_vars.hasOwnProperty("authorizing_type"),n=t.hasOwnProperty("parking_slot");return e||n};["CHANNEL_ANSWER","CHANNEL_CREATE","CHANNEL_DESTROY","CHANNEL_HOLD","CHANNEL_UNHOLD","PARK_ABANDONED","PARK_PARKED","PARK_RETRIEVED"].forEach(function(i){e.subscribeWebSocket({binding:"call."+i+".*",requiredElement:t.parent.find("#operator_app_container"),callback:function(l){a(l)&&(t.data=l,e.formatWebSocket(t),e[n(i)](t))}})})},render:function(t){var e=this;a.ui.generateAppLayout(e,{menus:[{tabs:[{callback:e.renderDashboard}]}]})},renderDashboard:function(t){var l=this,r=t.container,o=function(o){var s=e(a.template(l,"app"));l.hasProVersion&&(a.util.isMasquerading()?i.warning(l.i18n.active().operatorApp.pro.masqueradingAlert):l.proPaintMainTemplate(s,o)),r.fadeOut(function(){e(this).empty().append(s).fadeIn(function(){n.each(o.channels,function(e,a){e.hasOwnProperty("authorizing_type")&&e.hasOwnProperty("other_leg")&&l.renderCallElement(n.extend(t,{data:e}))}),n.each(o.parkedCalls,function(e){l.renderParkedCallElement(n.extend(t,{data:e}))}),n.each(o.users,function(e){var a=e.first_name+" "+e.last_name;l.renderUserElement(n.extend(t,{data:{presenceId:e.presence_id,id:e.id,title:e.hasOwnProperty("presence_id")?a+" ("+e.presence_id+")":a,search:(e.hasOwnProperty("presence_id")?a+" "+e.presence_id:a).toLowerCase(),type:"user"}}))}),n.each(o.devices,function(e){l.renderDeviceElement(n.extend(t,{data:{id:e.id,title:e.name,search:e.name.toLowerCase(),type:"device"}}))}),r.find(".entities-listing").isotope({getSortData:{name:function(t){return t.find(".element-title").text().toLowerCase()}},sortBy:"name",layoutMode:"fitRows",itemSelector:".entity-element"}),e(window).resize(function(t){var n=e(window).height()-296;r.find(".panel-content").css("height",n+"px")}),e(window).resize()}),l.bindDashboardEvents(t)})};a.parallel({devices:function(t){l.requestListDevices({success:function(e){t(null,e)}})},parkedCalls:function(t){l.requestListParkedCalls({success:function(e){t(null,e)}})},users:function(t){l.requestListUsers({success:function(e){t(null,e)}})}},function(e,a){l.requestListChannels({success:function(e){a.channels=e,l.formatChannels(a),l.formatParkedCall(a);var i=function(e){o(e),l.initWebSocket(n.extend(t,e))};l.hasProVersion?l.proGetDashboardData(a,function(t){i(t)}):i(a)}})})},renderCallElement:function(t){var i,l,r=this,o=t.data,s=e("#monster_content"),c=e("#monster_content .app-content-wrapper"),p=o.hasOwnProperty("deviceId")?o.deviceId:o.hasOwnProperty("uuid")?o.authorizing_id:o.custom_channel_vars.authorizing_id,d=n.find(t.devices,function(t){return t.id===p}),u=n.find(t.users,function(t){return t.id===(d||{}).owner_id});if(u&&u.id===r.userId)if(i=o.formatted,i.isRetrievable=a.webphone.isRetrievable(i.callId),i.caller=n.extend({},i.caller,i.caller.user,i.caller.device),i.callee=n.extend({},i.callee,i.callee.user,i.callee.device),l={parent:s,container:c,data:i},o.formatted.hasOwnProperty("webphone"))r.paintCallElement(l);else switch(o.event_name){case"CHANNEL_CREATE":r.renderCreateCallElement(l);break;case"CHANNEL_ANSWER":r.renderAnswerCallElement(l);break;case"CHANNEL_DESTROY":r.renderDestroyCallElement(l);break;default:r.renderCreateCallElement(l)}},paintCallElement:function(t){var n=this,i=t.data,l=t.container||e("#monster_content .app-content-wrapper"),r=e(a.template(n,"call-element",i));"active"===i.event&&n.initTimer(r.find(".elapsed-time"),i),n.hasProVersion&&(r=n.proRenderCallElementActions(r,t.data)),l.find("#in_progress_calls").removeClass("empty").append(r),"active"===i.event&&n.initTimer(l.find("#in_progress_calls").find('li[data-id="'+i.callId+'"]').find(".elapsed-time"),i)},renderCreateCallElement:function(t){var e=this;t.data.hasOwnProperty("callee")&&t.data.callee.hasOwnProperty("id")&&a.webphone.hasOwnProperty("device")&&t.data.callee.id===a.webphone.device.id&&"ringing"===t.data.event||e.paintCallElement(t)},renderAnswerCallElement:function(t){var n=this,i=t.data,l=t.container,r=e(a.template(n,"call-element",i)),o=l.find("#in_progress_calls").find('li[data-id="'+i.callId+'"]');n.initTimer(r.find(".elapsed-time"),i),n.hasProVersion&&(r=n.proRenderCallElementActions(r)),o.replaceWith(r)},renderDestroyCallElement:function(t){var n=this,i=t.data,l=t.container,r=a.template(n,"call-element",i),o=l.find("#in_progress_calls").find('li[data-id="'+i.callId+'"]');o.length?o.replaceWith(r):l.find("#in_progress_calls").append(r),setTimeout(function(){l.find("#in_progress_calls").find('li[data-id="'+i.callId+'"]').fadeOut(1e3,function(){e(this).remove(),1===l.find("#in_progress_calls li").length&&l.find("#in_progress_calls").addClass("empty")})},4e3)},renderParkedCallElement:function(t){var n=this,i=t.data,l=t.container,r=i.formatted,o=e(a.template(n,"call-element",r));n.hasProVersion&&(o=n.proRenderCallElementActions(o,r)),l.find("#parked_calls").removeClass("empty").append(o)},renderRetrievedCallElement:function(t){var n=t.data,a=t.container;a.find('li[data-slot="'+n.parking_slot+'"]').fadeOut(function(){e(this).remove(),1===a.find("#parked_calls li").length&&a.find("#parked_calls").addClass("empty")})},renderAbandonedCallElement:function(t){var n=t.data,a=t.container;a.find('li[data-slot="'+n.parking_slot+'"]').fadeOut(function(){e(this).remove(),1===a.find("#parked_calls li").length&&a.find("#parked_calls").addClass("empty")})},renderUserElement:function(t){var i,l=this,r=t.data,o=t.container,s=n.find(t.channels,function(t,e){var n="inbound"===t.direction&&t.formatted.caller.hasOwnProperty("user"),a="outbound"===t.direction&&t.formatted.callee.hasOwnProperty("user");return(n||a)&&t.owner_id===r.id}),c=e.extend(!0,{event:s?s.formatted.event:"idle"},r),p=l.renderEntityElement(c);o.find("#user").append(p),s&&(c.caller=n.extend({},s.formatted.caller,s.formatted.caller.user,s.formatted.caller.device),c.callee=n.extend({},s.formatted.callee,s.formatted.callee.user,s.formatted.callee.device),c.direction=s.formatted.direction,c.elapsedTime=s.formatted.elapsedTime,i=e(a.template(l,"entity-element-content",c)),l.initTimer(i.find(".elapsed-time"),c),o.find('li[data-id="'+r.id+'"]').find(".entity-element-content").append(i))},renderEntityElement:function(t){var n=this,i=e(a.template(n,"entity-element",t));return n.hasProVersion&&"user"===t.type&&!a.util.isMasquerading()&&n.proAddEntityActions(i),i},renderDeviceElement:function(t){var i,l=this,r=t.data,o=t.container,s=n.find(t.channels,function(t,e){var n="inbound"===t.direction&&t.formatted.caller.hasOwnProperty("device"),a="outbound"===t.direction&&t.formatted.callee.hasOwnProperty("device");return(n||a)&&t.authorizing_id===r.id}),c=e.extend(!0,{event:s?s.formatted.event:"idle"},r),p=l.renderEntityElement(c);o.find("#device").append(p),s&&(c.caller=n.extend({},s.formatted.caller,s.formatted.caller.device,s.formatted.caller.user),c.callee=n.extend({},s.formatted.callee,s.formatted.callee.device,s.formatted.callee.user),c.direction=s.formatted.direction,c.elapsedTime=s.formatted.elapsedTime,i=e(a.template(l,"entity-element-content",c)),l.initTimer(i.find(".elapsed-time"),c),o.find('li[data-id="'+r.id+'"]').find(".entity-element-content").append(i))},renderIdleUserElement:function(t){var e=t.data,n=t.container,a=e.custom_channel_vars.owner_id;n.find('li[data-id="'+a+'"]').removeClass("active ringing").addClass("idle").find(".entity-element-content").empty(),n.find("#user").isotope()},renderIdleDeviceElement:function(t){var e=t.data,n=t.container,a=e.custom_channel_vars.authorizing_id;n.find('li[data-id="'+a+'"]').removeClass("active ringing").addClass("idle").find(".entity-element-content").empty(),n.find("#device").isotope()},renderRingingUserElement:function(t){var i,l=this,r=t.data,o=t.container,s=r.formatted,c=r.custom_channel_vars.owner_id,p=o.find('li[data-id="'+c+'"]'),d=e.extend(!0,{},s);d.caller=n.extend({},s.caller,s.caller.user,s.caller.device),d.callee=n.extend({},s.callee,s.callee.user,s.callee.device),i=e(a.template(l,"entity-element-content",d)),l.initTimer(i.find(".elapsed-time"),d),p.removeClass("idle active").addClass("ringing").find(".entity-element-content").empty().append(i),o.find("#user").isotope()},renderRingingDeviceElement:function(t){var i,l=this,r=t.data,o=t.container,s=r.formatted,c=r.custom_channel_vars.authorizing_id,p=o.find('li[data-id="'+c+'"]'),d=e.extend(!0,{},s);d.caller=n.extend({},s.caller,s.caller.device,s.caller.user),d.callee=n.extend({},s.callee,s.callee.device,s.callee.user),i=e(a.template(l,"entity-element-content",d)),l.initTimer(i.find(".elapsed-time"),d),p.removeClass("idle active").addClass("ringing").find(".entity-element-content").empty().append(a.template(l,"entity-element-content",d)),o.find("#device").isotope()},renderActiveUserElement:function(t){var i,l=this,r=t.data,o=t.container,s=r.formatted,c=(r.hasOwnProperty("custom_channel_vars")?r.custom_channel_vars:r).owner_id,p=o.find('li[data-id="'+c+'"]'),d=e.extend(!0,{},s);d.caller=n.extend({},s.caller,s.caller.user,s.caller.device),d.callee=n.extend({},s.callee,s.callee.user,s.callee.device),i=e(a.template(l,"entity-element-content",d)),l.initTimer(i.find(".elapsed-time"),d),p.removeClass("idle ringing").addClass("active").find(".entity-element-content").empty().append(i),o.find(".entities-listing").isotope()},renderActiveDeviceElement:function(t){var i,l=this,r=t.data,o=t.container,s=r.formatted,c=(r.hasOwnProperty("custom_channel_vars")?r.custom_channel_vars:r).authorizing_id,p=o.find('li[data-id="'+c+'"]'),d=e.extend(!0,{},s);d.caller=n.extend({},s.caller,s.caller.device,s.caller.user),d.callee=n.extend({},s.callee,s.callee.device,s.callee.user),i=e(a.template(l,"entity-element-content",d)),l.initTimer(i.find(".elapsed-time"),d),p.removeClass("idle ringing").addClass("active").find(".entity-element-content").empty().append(a.template(l,"entity-element-content",d)),o.find(".entities-listing").isotope()},bindDashboardEvents:function(t){var n=this,a=t.container,i=a.find("#entities_navbar"),l=a.find("#entities_search"),r=a.find("#entities_filters");i.find(".navbar-menu-item-link").on("click",function(t){t.preventDefault();var n=e(this),o=n.data("type");n.hasClass("active")||(i.find(".navbar-menu-item-link.active").removeClass("active"),n.addClass("active"),l.find("input").val(""),r.find("li").first().click(),a.find(".entities-listing.active").fadeOut(function(){e(this).removeClass("active"),a.find("#"+o).fadeIn(function(){e(this).addClass("active")})}))}),l.find("input").on("keyup",function(t){t.preventDefault();var n=e(this).val().toLowerCase(),l=i.find("a.active").data("type"),o=r.find("li.active a").data("filter");"available"===o?(o=".entity-element.idle",n&&(o+='[data-search*="'+n+'"]')):"busy"===o?(o=".entity-element.ringing .entity-element.active",n&&(o=o.split(" ").join('[data-search*="'+n+'"], ')+'[data-search*="'+n+'"]')):(o=".entity-element",n&&(o+='[data-search*="'+n+'"]')),a.find("#"+l).isotope({filter:o})}),r.find("li").on("click",function(t){t.preventDefault();var n=e(this),o=i.find("a.active").data("type"),s=n.find("a").data("filter");l.find("input").val(""),n.hasClass("active")||(r.find("li.active").removeClass("active"),n.addClass("active")),s="available"===s?".entity-element.idle":"busy"===s?".entity-element.ringing, .entity-element.active":".entity-element",a.find("#"+o).isotope({filter:s})}),n.hasProVersion&&n.proBindBottomBarEvents(t)},onChannelHold:function(){},onChannelUnhold:function(){},onChannelCreate:function(t){var e=this;if(t.data.custom_channel_vars.hasOwnProperty("owner_id")){var n=t.data.custom_channel_vars.authorizing_id,a=t.data.custom_channel_vars.owner_id,i=t.data.call_id;e.appFlags.users[a][i]=t.data,e.appFlags.devices[n][i]=t.data}e.renderCallElement(t),e.renderRingingUserElement(t),e.renderRingingDeviceElement(t)},onChannelAnswer:function(t){var e=this;if(t.data.custom_channel_vars.hasOwnProperty("owner_id")){var n=t.data.custom_channel_vars.authorizing_id,a=t.data.custom_channel_vars.owner_id,i=t.data.call_id;e.appFlags.users[a][i]=t.data,e.appFlags.devices[n][i]=t.data}e.renderCallElement(t),e.renderActiveUserElement(t),e.renderActiveDeviceElement(t)},onChannelDestroy:function(t){var e,a,i,l=this,r=!1,o=!1;t.data.custom_channel_vars.hasOwnProperty("owner_id")&&(e=t.data.custom_channel_vars.authorizing_id,a=t.data.custom_channel_vars.owner_id,i=t.data.call_id,delete l.appFlags.users[a][i],delete l.appFlags.devices[e][i],o=!n.isEmpty(l.appFlags.users[a]),r=!n.isEmpty(l.appFlags.devices[e])),l.renderCallElement(t),o?l.renderActiveUserElement(n.extend({},t,{data:l.appFlags.users[a][n.last(n.keys(l.appFlags.users[a]))]})):l.renderIdleUserElement(t),r?l.renderActiveDeviceElement(n.extend({},t,{data:l.appFlags.devices[e][n.last(n.keys(l.appFlags.devices[e]))]})):l.renderIdleDeviceElement(t)},onParkParked:function(t){this.renderParkedCallElement(t)},onParkRetrieved:function(t){this.renderRetrievedCallElement(t)},onParkAbandoned:function(t){this.renderAbandonedCallElement(t)},initTimer:function(t,e){var n;n=Math.floor(((new Date).getTime()-e.elapsedTime)/1e3),a.ui.timer(t,n,!1)},formatChannels:function(t){var a=this,i=t.users,l=t.devices,r=t.channels,o=function(t,e){var a,r,o={};return t&&(r=n.find(i,function(e){return e.id===t}),o.user={id:r.id,label:r.first_name+" "+r.last_name},r.hasOwnProperty("presence_id")&&(o.user.label+=" ("+r.presence_id+")")),e&&(a=n.find(l,function(t){return t.id===e}),o.device={id:e,label:(a||{}).name}),o},s=function(t){return t?"active":"ringing"};n.each(r,function(t){var n=t.hasOwnProperty("authorizing_type")&&"device"===t.authorizing_type&&t.hasOwnProperty("authorizing_id")&&t.authorizing_id,i=t.hasOwnProperty("owner_id")&&t.owner_id,l=!t.hasOwnProperty("authorizing_type"),c={},p={},d={};"inbound"===t.direction?(l?c.label=t.hasOwnProperty("presence_id")?t.presence_id.split("@")[0]:a.i18n.active().operatorApp.callTexts.unknown:c=o(i,n),(!t.hasOwnProperty("formatted")||t.hasOwnProperty("formatted")&&!t.formatted.hasOwnProperty("callee"))&&(d={formatted:{callee:{label:t[t.hasOwnProperty("other_leg")?"presence_id":"destination"]}}}),e.extend(!0,t,{formatted:{callId:t.uuid,event:s(t.answered),direction:"outbound",elapsedTime:a.getTimestampFromSeconds(t.elapsed_s),caller:c,isOnHold:t.is_onhold}},d),e.extend(!0,r[t.other_leg],{formatted:{caller:c}})):(l?p.label=t.destination:p=o(i,n),(!t.hasOwnProperty("formatted")||t.hasOwnProperty("formatted")&&!t.formatted.hasOwnProperty("caller"))&&(d={formatted:{caller:{label:t.destination}}}),e.extend(!0,t,{formatted:{callId:t.uuid,event:s(t.answered),direction:"inbound",elapsedTime:a.getTimestampFromSeconds(t.elapsed_s),callee:p,isOnHold:t.is_onhold}},d),e.extend(!0,r[t.other_leg],{formatted:{callee:p}}))}),n.each(r,function(t){t.hasOwnProperty("owner_id")&&t.hasOwnProperty("authorizing_type")&&(a.appFlags.users[t.owner_id][t.uuid]=t),t.hasOwnProperty("authorizing_id")&&a.appFlags.devices.hasOwnProperty(t.authorizing_id)&&(a.appFlags.devices[t.authorizing_id][t.uuid]=t)})},formatParkedCall:function(t){var a,i=t.parkedCalls;n.each(i,function(t){a=t.cid_name,t.cid_number.indexOf(a)<0&&(a+=" ("+t.cid_number+")"),e.extend(!0,t,{formatted:{callId:t.call_id,parkingSlot:t.parking_slot,event:"parked",label:a}})})},formatWebSocket:function(t){var i=this,l=t.data,r=t.users,o=t.devices,s=function(t){var e,i,l={};return t.custom_channel_vars.hasOwnProperty("owner_id")&&(i=n.find(r,function(e){return e.id===t.custom_channel_vars.owner_id}),l.user=void 0===i?{id:"_unknown",label:"N/A"}:{id:i.id,label:i.first_name+" "+i.last_name},i.hasOwnProperty("presence_id")&&(l.user.label+=" ("+i.presence_id+")")),t.custom_channel_vars.hasOwnProperty("authorizing_type")?(e=n.find(o,function(e){return e.id===t.custom_channel_vars.authorizing_id}),l.device=void 0===e?{id:"_unknown",label:"N/A"}:{id:e.id,label:e.name}):l.label=a.util.formatPhoneNumber(t.custom_channel_vars.e164_destination),l},c={callId:l.call_id,event:function(t){var e;switch(t){case"CHANNEL_CREATE":e="ringing";break;case"CHANNEL_ANSWER":e="active";break;case"CHANNEL_DESTROY":e="ended";break;case"PARK_PARKED":e="parked";break;default:e=""}return e}(l.event_name),elapsedTime:i.getTimestampFromSeconds(0)};if(l.hasOwnProperty("parking_slot")){var p=l.caller_id_name;l.caller_id_number.indexOf(p)<0&&(p+=" ("+l.caller_id_number+")"),l.formatted=e.extend(!0,c,{parkingSlot:l.parking_slot,label:p})}else c.direction=function(t){return"inbound"===t?"outbound":"inbound"}(l.call_direction),"inbound"===l.call_direction?l.formatted=e.extend(!0,c,{caller:s(l),callee:{label:l.hasOwnProperty("callee_id_name")?l.callee_id_name:l.to.split("@")[0]}}):l.formatted=e.extend(!0,c,{caller:{label:l.caller_id_name},callee:s(l)})},getTimestampFromSeconds:function(t){return(new Date).getTime()-1e3*t},requestListChannels:function(t){var e=this;e.callApi({resource:"channel.list",data:{accountId:e.accountId},success:function(e,n){e.data=e.data.reduce(function(t,e){return t[e.uuid]=e,t},{}),t.hasOwnProperty("success")&&t.success(e.data)},error:function(e,n){t.hasOwnProperty("error")&&t.error()}})},requestListUsers:function(t){var e=this;e.callApi({resource:"user.list",data:{accountId:e.accountId,filters:{paginate:!1}},success:function(a,i){n.each(a.data,function(t){e.appFlags.users[t.id]={}}),t.hasOwnProperty("success")&&t.success(a.data)},error:function(e,n){t.hasOwnProperty("error")&&t.error()}})},requestListDevices:function(t){var e=this;e.callApi({resource:"device.list",data:{accountId:e.accountId,filters:{paginate:!1}},success:function(a,i){n.each(a.data,function(t){e.appFlags.devices[t.id]={}}),t.hasOwnProperty("success")&&t.success(a.data)},error:function(e,n){t.hasOwnProperty("error")&&t.error()}})},requestListParkedCalls:function(t){var e=this;e.callApi({resource:"parkedCalls.list",data:{accountId:e.accountId},success:function(e,a){var i=n.reduce(e.data.slots,function(t,e,n){return e.parking_slot=n,t.concat(e)},[]);t.hasOwnProperty("success")&&t.success(i)},error:function(e,n){t.hasOwnProperty("error")&&t.error()}})}}}),this.monster=this.monster||{},this.monster.cache=this.monster.cache||{},this.monster.cache.templates=this.monster.cache.templates||{},this.monster.cache.templates["operator-pro"]=this.monster.cache.templates["operator-pro"]||{},this.monster.cache.templates["operator-pro"]._main=this.monster.cache.templates["operator-pro"]._main||{},this.monster.cache.templates["operator-pro"]._main.app=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,a,i){var l,r=t.lambda,o=t.escapeExpression;return'<div class="app-content operator-app-container">\n\t<div class="side left-side">\n\t\t<section>\n\t\t\t<header class="panel-title">\n\t\t\t\t'+o(r(null!=(l=null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.panel:l)?l.title:l)?l.myActiveIncomingCalls:l,e))+'\n\t\t\t</header>\n\t\t\t<ul class="calls-listing empty" id="in_progress_calls">\n\t\t\t\t<li class="empty-state">\n\t\t\t\t\t'+o(r(null!=(l=null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.panel:l)?l.empty:l)?l.noActiveCalls:l,e))+'\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</section>\n\t\t<section>\n\t\t\t<header class="panel-title">\n\t\t\t\t'+o(r(null!=(l=null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.panel:l)?l.title:l)?l.myParkedCalls:l,e))+'\n\t\t\t</header>\n\t\t\t<ul class="calls-listing empty" id="parked_calls">\n\t\t\t\t<li class="empty-state">\n\t\t\t\t\t'+o(r(null!=(l=null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.panel:l)?l.empty:l)?l.noParkedCalls:l,e))+'\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</section>\n\t</div>\n\t<div class="side right-side">\n\t\t<section class="panel" id="entities">\n\t\t\t<nav class="panel-navbar monster-navbar" id="entities_navbar">\n\t\t\t\t<ul class="navbar-menu">\n\t\t\t\t\t<li class="navbar-menu-item">\n\t\t\t\t\t\t<a href="#" class="navbar-menu-item-link active" data-type="user">\n\t\t\t\t\t\t\t'+o(r(null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.employees:l,e))+'\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class="navbar-menu-item">\n\t\t\t\t\t\t<a href="#" class="navbar-menu-item-link" data-type="device">\n\t\t\t\t\t\t\t'+o(r(null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.devices:l,e))+'\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</nav>\n\t\t\t<div class="panel-actions">\n\t\t\t\t<div class="monster-search pull-left" id="entities_search">\n\t\t\t\t\t<i class="fa fa-search"></i>\n\t\t\t\t\t<input type="text" placeholder="Search...">\n\t\t\t\t</div>\n\t\t\t\t<ul class="monster-pills pull-right" id="entities_filters">\n\t\t\t\t\t<li class="active">\n\t\t\t\t\t\t<a href="#">\n\t\t\t\t\t\t\t'+o(r(null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.filters:l)?l.all:l,e))+'\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a href="#" data-filter="available">\n\t\t\t\t\t\t\t'+o(r(null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.filters:l)?l.available:l,e))+'\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<a href="#" data-filter="busy">\n\t\t\t\t\t\t\t'+o(r(null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.filters:l)?l.busy:l,e))+'\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t\t<div class="panel-content">\n\t\t\t\t<ul class="entities-listing active" id="user"></ul>\n\t\t\t\t<ul class="entities-listing" id="device"></ul>\n\t\t\t</div>\n\t\t</section>\n\t</div>\n</div>\n'},useData:!0}),this.monster.cache.templates["operator-pro"]._main["call-element"]=Handlebars.template({1:function(t,e,n,a,i){return" hold"},3:function(t,e,n,a,i){return" retrievable"},5:function(t,e,n,a,i){return" webphone"},7:function(t,e,n,a,i){var l;return' data-slot="'+t.escapeExpression((l=null!=(l=n.parkingSlot||(null!=e?e.parkingSlot:e))?l:n.helperMissing,"function"==typeof l?l.call(null!=e?e:t.nullContext||{},{name:"parkingSlot",hash:{},data:i}):l))+'"'},9:function(t,e,n,a,i){var l;return'\t\t\t<i class="icon-telicon-'+t.escapeExpression((l=null!=(l=n.direction||(null!=e?e.direction:e))?l:n.helperMissing,"function"==typeof l?l.call(null!=e?e:t.nullContext||{},{name:"direction",hash:{},data:i}):l))+'-call"></i>\n'},11:function(t,e,n,a,i){var l,r=null!=e?e:t.nullContext||{},o=n.helperMissing,s=t.escapeExpression;return'\t\t\t<div>\n\t\t\t\t<div class="info-label">\n\t\t\t\t\tCall ID\n\t\t\t\t</div>\n\t\t\t\t<div class="info-value">\n\t\t\t\t\t'+s((l=null!=(l=n.label||(null!=e?e.label:e))?l:o,"function"==typeof l?l.call(r,{name:"label",hash:{},data:i}):l))+'\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<div class="info-label">\n\t\t\t\t\tSpot\n\t\t\t\t</div>\n\t\t\t\t<div class="info-value">\n\t\t\t\t\t'+s((l=null!=(l=n.parkingSlot||(null!=e?e.parkingSlot:e))?l:o,"function"==typeof l?l.call(r,{name:"parkingSlot",hash:{},data:i}):l))+"\n\t\t\t\t</div>\n\t\t\t</div>\n"},13:function(t,e,n,a,i){var l,r=t.lambda,o=t.escapeExpression;return'\t\t\t<div>\n\t\t\t\t<div class="info-label">\n\t\t\t\t\tFrom:\n\t\t\t\t</div>\n\t\t\t\t<div class="info-value">\n\t\t\t\t\t'+o(r(null!=(l=null!=e?e.caller:e)?l.label:l,e))+'\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<div class="info-label">\n\t\t\t\t\tTo:\n\t\t\t\t</div>\n\t\t\t\t<div class="info-value">\n\t\t\t\t\t'+o(r(null!=(l=null!=e?e.callee:e)?l.label:l,e))+"\n\t\t\t\t</div>\n\t\t\t</div>\n"},15:function(t,e,n,a,i){return"\t\t\t\tRinging\n"},17:function(t,e,n,a,i){return'\t\t\t\t<span class="elapsed-time"></span>\n'},19:function(t,e,n,a,i){return"\t\t\t\tCall Ended\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,a,i){var l,r,o=null!=e?e:t.nullContext||{},s=n.helperMissing,c=t.escapeExpression;return'<li class="call-element '+c((r=null!=(r=n.event||(null!=e?e.event:e))?r:s,"function"==typeof r?r.call(o,{name:"event",hash:{},data:i}):r))+(null!=(l=n.if.call(o,null!=e?e.isOnHold:e,{name:"if",hash:{},fn:t.program(1,i,0),inverse:t.noop,data:i}))?l:"")+(null!=(l=n.if.call(o,null!=e?e.isRetrievable:e,{name:"if",hash:{},fn:t.program(3,i,0),inverse:t.noop,data:i}))?l:"")+(null!=(l=n.if.call(o,null!=e?e.isWebphone:e,{name:"if",hash:{},fn:t.program(5,i,0),inverse:t.noop,data:i}))?l:"")+'" data-id="'+c((r=null!=(r=n.callId||(null!=e?e.callId:e))?r:s,"function"==typeof r?r.call(o,{name:"callId",hash:{},data:i}):r))+'"'+(null!=(l=(n.compare||e&&e.compare||s).call(o,null!=e?e.event:e,"===","parked",{name:"compare",hash:{},fn:t.program(7,i,0),inverse:t.noop,data:i}))?l:"")+">"+c((r=null!=(r=n.debug||(null!=e?e.debug:e))?r:s,"function"==typeof r?r.call(o,{name:"debug",hash:{},data:i}):r))+'\n\t<div class="call-element-content">\n\t\t<div class="icon-wrapper pull-left">\n'+(null!=(l=(n.compare||e&&e.compare||s).call(o,null!=e?e.event:e,"!==","parked",{name:"compare",hash:{},fn:t.program(9,i,0),inverse:t.noop,data:i}))?l:"")+'\t\t</div>\n\t\t<div class="info-wrapper pull-left">\n'+(null!=(l=(n.compare||e&&e.compare||s).call(o,null!=e?e.event:e,"===","parked",{name:"compare",hash:{},fn:t.program(11,i,0),inverse:t.program(13,i,0),data:i}))?l:"")+'\t\t</div>\n\t\t<div class="status-wrapper pull-right">\n\t\t\t<div class="status-label">\n'+(null!=(l=(n.compare||e&&e.compare||s).call(o,null!=e?e.event:e,"===","ringing",{name:"compare",hash:{},fn:t.program(15,i,0),inverse:t.noop,data:i}))?l:"")+(null!=(l=(n.compare||e&&e.compare||s).call(o,null!=e?e.event:e,"===","active",{name:"compare",hash:{},fn:t.program(17,i,0),inverse:t.noop,data:i}))?l:"")+(null!=(l=(n.compare||e&&e.compare||s).call(o,null!=e?e.event:e,"===","ended",{name:"compare",hash:{},fn:t.program(19,i,0),inverse:t.noop,data:i}))?l:"")+"\t\t\t</div>\n\t\t</div>\n\t</div>\n</li>\n"},useData:!0}),this.monster.cache.templates["operator-pro"]._main["entity-element-content"]=Handlebars.template({1:function(t,e,n,a,i){var l;return"\t"+t.escapeExpression(t.lambda((l=(l=(l=(l=i&&i.root)&&l.i18n)&&l.operatorApp)&&l.callTexts)&&l.ringing,e))+"\n"},3:function(t,e,n,a,i){var l;return"\t"+t.escapeExpression(t.lambda((l=(l=(l=(l=i&&i.root)&&l.i18n)&&l.operatorApp)&&l.callTexts)&&l.onCall,e))+"\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,a,i){var l,r,o=null!=e?e:t.nullContext||{},s=n.helperMissing,c=t.escapeExpression,p=t.lambda;return'<div class="event-type">\n'+(null!=(l=(n.compare||e&&e.compare||s).call(o,null!=e?e.event:e,"===","ringing",{name:"compare",hash:{},fn:t.program(1,i,0),inverse:t.program(3,i,0),data:i}))?l:"")+'\t<i class="icon-telicon-'+c((r=null!=(r=n.direction||(null!=e?e.direction:e))?r:s,"function"==typeof r?r.call(o,{name:"direction",hash:{},data:i}):r))+'-call"></i>\n\t<span class="elapsed-time"></span>\n</div>\n<div>\n\t<div class="info-label">\n\t\t'+c(p((l=(l=(l=(l=i&&i.root)&&l.i18n)&&l.operatorApp)&&l.callTexts)&&l.from,e))+':\n\t</div>\n\t<div class="info-value">\n\t\t'+c(p(null!=(l=null!=e?e.caller:e)?l.label:l,e))+'\n\t</div>\n</div>\n<div>\n\t<div class="info-label">\n\t\t'+c(p((l=(l=(l=(l=i&&i.root)&&l.i18n)&&l.operatorApp)&&l.callTexts)&&l.to,e))+':\n\t</div>\n\t<div class="info-value">\n\t\t'+c(p(null!=(l=null!=e?e.callee:e)?l.label:l,e))+"\n\t</div>\n</div>\n"},useData:!0}),this.monster.cache.templates["operator-pro"]._main["entity-element"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,a,i){var l,r=null!=e?e:t.nullContext||{},o=n.helperMissing,s="function",c=t.escapeExpression;return'<li class="entity-element '+c((l=null!=(l=n.event||(null!=e?e.event:e))?l:o,typeof l===s?l.call(r,{name:"event",hash:{},data:i}):l))+'" data-id="'+c((l=null!=(l=n.id||(null!=e?e.id:e))?l:o,typeof l===s?l.call(r,{name:"id",hash:{},data:i}):l))+'" data-search="'+c((l=null!=(l=n.search||(null!=e?e.search:e))?l:o,typeof l===s?l.call(r,{name:"search",hash:{},data:i}):l))+'" data-presence-id="'+c((l=null!=(l=n.presenceId||(null!=e?e.presenceId:e))?l:o,typeof l===s?l.call(r,{name:"presenceId",hash:{},data:i}):l))+'" data-type="'+c((l=null!=(l=n.type||(null!=e?e.type:e))?l:o,typeof l===s?l.call(r,{name:"type",hash:{},data:i}):l))+'">\n\t<div class="user-info-wrapper">\n\t\t<div class="element-title">\n\t\t\t'+c((l=null!=(l=n.title||(null!=e?e.title:e))?l:o,typeof l===s?l.call(r,{name:"title",hash:{},data:i}):l))+'\n\t\t</div>\n\t\t<div class="entity-element-content">\n\t\t</div>\n\t</div>\n</li>\n'},useData:!0}),this.monster.cache.templates["operator-pro"]._main["pro-actions-entities"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,a,i){var l,r=t.lambda,o=t.escapeExpression;return'<div class="choice-actions">\n\t<button class="call monster-button-primary">\n\t\t<i class="fa fa-phone"></i>\n\t\t'+o(r(null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.pro:l)?l.call:l,e))+'\n\t</button>\n\n\t<button class="cancel monster-button">\n\t\t'+o(r(null!=(l=null!=e?e.i18n:e)?l.cancel:l,e))+"\n\t</button>\n</div>"},useData:!0}),this.monster.cache.templates["operator-pro"]._main["pro-bottom-bar"]=Handlebars.template({1:function(t,e,n,a,i){var l,r,o,s='\n\t\t<div class="toggle-webphone pull-right">\n\t\t\t<span class="title">'+t.escapeExpression(t.lambda(null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.pro:l)?l.webphone:l,e))+"</span>\n";return r=null!=(r=n.monsterSwitch||(null!=e?e.monsterSwitch:e))?r:n.helperMissing,o={name:"monsterSwitch",hash:{},fn:t.program(2,i,0),inverse:t.noop,data:i},l="function"==typeof r?r.call(null!=e?e:t.nullContext||{},o):r,n.monsterSwitch||(l=n.blockHelperMissing.call(e,l,o)),null!=l&&(s+=l),s+"\t\t</div>\n\t"},2:function(t,e,n,a,i){var l;return'\t\t\t\t<input class="switch-state toggle-webphone" type="checkbox" data-on="" data-off=""'+(null!=(l=n.if.call(null!=e?e:t.nullContext||{},null!=e?e.isWebphoneConnected:e,{name:"if",hash:{},fn:t.program(3,i,0),inverse:t.noop,data:i}))?l:"")+"></input>\n"},3:function(t,e,n,a,i){return" checked"},compiler:[7,">= 4.0.0"],main:function(t,e,n,a,i){var l
;return'<div class="bottom-bar">\n\t<div class="quickcall-button monster-button-primary bar-button pull-left">\n\t\t<i class="fa fa-phone"></i>\n\t</div>\n\n\t<div class="webphone-actions">\n\t\t<div class="hangup monster-button-danger bar-button pull-left">\n\t\t\t<i class="icon-telicon-hangup"></i>\n\t\t</div>\n\n\t\t<div class="action-block current-call">\n\t\t\t<div class="timer upper-text"></div>\n\t\t\t<div class="ringing-text upper-text">'+t.escapeExpression(t.lambda(null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.pro:l)?l.ringing:l,e))+'</div>\n\n\t\t\t<div class="phone-number"></div>\n\t\t</div>\n\n\t\t<div class="on-call-actions">\n\t\t\t<div class="action-block feature" data-feature="mute">\n\t\t\t\t<i class="fa fa-microphone"></i>\n\t\t\t\t<i class="fa fa-microphone-slash active-icon"></i>\n\t\t\t</div>\n\n\t\t\t<div class="action-block feature" data-feature="dialpad">\n\t\t\t\t<i class="icon-telicon-apps"></i>\n\t\t\t</div>\n\n\t\t\t<div class="action-block feature" data-feature="hold">\n\t\t\t\t<i class="fa fa-pause"></i>\n\t\t\t\t<i class="fa fa-pause active-icon"></i>\n\t\t\t</div>\n\n\t\t\t\x3c!-- <div class="action-block feature" data-feature="hold">\n\t\t\t\t<i class="fa fa-pause"></i>\n\t\t\t</div>\n\n\t\t\t<div class="action-block feature filled" data-feature="transfer">\n\t\t\t\t<i class="fa fa-arrow-right"></i>\n\t\t\t</div>\n\n\t\t\t<div class="action-block feature filled" data-feature="park">\n\t\t\t\tP\n\t\t\t</div> --\x3e\n\t\t</div>\n\t</div>\n\n\t\x3c!-- We don\'t want to expose this for now --\x3e\n\t\x3c!-- '+(null!=(l=n.if.call(null!=e?e:t.nullContext||{},null!=e?e.hasWebphone:e,{name:"if",hash:{},fn:t.program(1,i,0),inverse:t.noop,data:i}))?l:"")+" --\x3e\n</div>"},useData:!0}),this.monster.cache.templates["operator-pro"]._main["pro-call-element-actions"]=Handlebars.template({1:function(t,e,n,a,i){return'\t\t<div class="pull-left">\n\t\t\t<div class="element-action" data-action="unpark">\n\t\t\t\t<i class="fa fa-arrow-up"></i>\n\t\t\t</div>\n\t\t</div>\n'},3:function(t,e,n,a,i){var l;return null!=(l=n.if.call(null!=e?e:t.nullContext||{},null!=(l=null!=e?e.data:e)?l.isWebphone:l,{name:"if",hash:{},fn:t.program(4,i,0),inverse:t.program(9,i,0),data:i}))?l:""},4:function(t,e,n,a,i){var l;return null!=(l=(n.compare||e&&e.compare||n.helperMissing).call(null!=e?e:t.nullContext||{},null!=(l=null!=(l=null!=e?e.data:e)?l.webphone:l)?l.countActiveCalls:l,"<=",1,{name:"compare",hash:{},fn:t.program(5,i,0),inverse:t.program(7,i,0),data:i}))?l:""},5:function(t,e,n,a,i){var l,r=t.lambda,o=t.escapeExpression;return'\t\t\t\t<div class="element-action" data-action="pickup">\n\t\t\t\t\t<div class="upper">\n\t\t\t\t\t\t<i class="fa fa-phone monster-green"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="lower">\n\t\t\t\t\t\t'+o(r((l=(l=(l=(l=(l=i&&i.root)&&l.i18n)&&l.operatorApp)&&l.pro)&&l.webphoneCallElement)&&l.pickup,e))+'\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="element-action right-element" data-action="ignore">\n\t\t\t\t\t<div class="upper">\n\t\t\t\t\t\t<i class="icon-telicon-hangup monster-red"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="lower">\n\t\t\t\t\t\t'+o(r((l=(l=(l=(l=(l=i&&i.root)&&l.i18n)&&l.operatorApp)&&l.pro)&&l.webphoneCallElement)&&l.ignore,e))+"\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n"},7:function(t,e,n,a,i){var l,r=t.lambda,o=t.escapeExpression;return'\t\t\t\t<div class="element-action" data-action="hold-accept">\n\t\t\t\t\t<div class="upper">\n\t\t\t\t\t\t<i class="fa fa-pause monster-yellow"></i>\n\t\t\t\t\t\t<i class="fa fa-arrow-right monster-white"></i>\n\t\t\t\t\t\t<i class="fa fa-phone monster-green"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="lower">\n\t\t\t\t\t\t'+o(r((l=(l=(l=(l=(l=i&&i.root)&&l.i18n)&&l.operatorApp)&&l.pro)&&l.webphoneCallElement)&&l.holdAccept,e))+'\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="element-action" data-action="hangup-accept">\n\t\t\t\t\t<div class="upper">\n\t\t\t\t\t\t<i class="icon-telicon-hangup monster-red"></i>\n\t\t\t\t\t\t<i class="fa fa-arrow-right monster-white"></i>\n\t\t\t\t\t\t<i class="fa fa-phone monster-green"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="lower">\n\t\t\t\t\t\t'+o(r((l=(l=(l=(l=(l=i&&i.root)&&l.i18n)&&l.operatorApp)&&l.pro)&&l.webphoneCallElement)&&l.hangupAccept,e))+'\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="element-action" data-action="ignore">\n\t\t\t\t\t<div class="upper">\n\t\t\t\t\t\t<i class="icon-telicon-hangup monster-red"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="lower">\n\t\t\t\t\t\t'+o(r((l=(l=(l=(l=(l=i&&i.root)&&l.i18n)&&l.operatorApp)&&l.pro)&&l.webphoneCallElement)&&l.ignore,e))+"\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n"},9:function(t,e,n,a,i){var l;return'\t\t\t<div class="pull-left">\n\t\t\t\t<div class="element-action" data-action="hold">\n\t\t\t\t\t<i class="fa fa-pause"></i>\n\t\t\t\t</div>\n\t\t\t\t<div class="element-action" data-action="transfer">\n\t\t\t\t\t<i class="fa fa-arrow-right"></i>\n\t\t\t\t</div>\n\t\t\t\t<div class="element-action" data-action="park">\n\t\t\t\t\t<span>\n\t\t\t\t\t\tP\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="element-action retrievable" data-action="retrieve">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t'+t.escapeExpression(t.lambda((l=(l=(l=(l=(l=i&&i.root)&&l.i18n)&&l.operatorApp)&&l.pro)&&l.webphoneCallElement)&&l.pickup,e))+'\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="pull-right">\n\t\t\t\t<div class="element-action" data-action="hangup">\n\t\t\t\t\t<i class="icon-telicon-hangup"></i>\n\t\t\t\t</div>\n\t\t\t</div>\n'},compiler:[7,">= 4.0.0"],main:function(t,e,n,a,i){var l;return'<div class="call-element-actions">\n'+(null!=(l=(n.compare||e&&e.compare||n.helperMissing).call(null!=e?e:t.nullContext||{},null!=(l=null!=e?e.data:e)?l.event:l,"===","parked",{name:"compare",hash:{},fn:t.program(1,i,0),inverse:t.program(3,i,0),data:i}))?l:"")+"</div>\n"},useData:!0}),this.monster.cache.templates["operator-pro"]._main["pro-parking-popover"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,a,i){var l,r=t.lambda,o=t.escapeExpression;return'<div class="parking-popover">\n\t<div class="field-title">'+o(r(null!=(l=null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.pro:l)?l.parkingPopover:l)?l.title:l,e))+'</div>\n\n\t<form>\n\t\t<input type="text" class="parking-slot-number">\n\n\t\t<button id="park" type="submit" class="monster-button-warning">'+o(r(null!=(l=null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.pro:l)?l.parkingPopover:l)?l.park:l,e))+"</button>\n\t</form>\n</div>"},useData:!0}),this.monster.cache.templates["operator-pro"]._main["pro-quickcall-device"]=Handlebars.template({1:function(t,e,n,a,i){return" webphone"},compiler:[7,">= 4.0.0"],main:function(t,e,n,a,i){var l,r,o=null!=e?e:t.nullContext||{},s=n.helperMissing,c=t.escapeExpression;return'<li class="device'+(null!=(l=n.if.call(o,null!=e?e.isWebphone:e,{name:"if",hash:{},fn:t.program(1,i,0),inverse:t.noop,data:i}))?l:"")+'" data-id="'+c((r=null!=(r=n.id||(null!=e?e.id:e))?r:s,"function"==typeof r?r.call(o,{name:"id",hash:{},data:i}):r))+'" data-name="'+c((r=null!=(r=n.name||(null!=e?e.name:e))?r:s,"function"==typeof r?r.call(o,{name:"name",hash:{},data:i}):r))+'" data-original-title="'+c((r=null!=(r=n.name||(null!=e?e.name:e))?r:s,"function"==typeof r?r.call(o,{name:"name",hash:{},data:i}):r))+'" data-placement="top" data-toggle="tooltip">\n\t<div class="wrapper-icon">\n\t\t<i class="'+c((r=null!=(r=n.cssClass||(null!=e?e.cssClass:e))?r:s,"function"==typeof r?r.call(o,{name:"cssClass",hash:{},data:i}):r))+'"></i>\n\t</div>\n\t<div class="additional-text">'+c(t.lambda((l=(l=(l=(l=(l=i&&i.root)&&l.i18n)&&l.operatorApp)&&l.pro)&&l.quickCallPopover)&&l.connect,e))+"</div>\n</li>"},useData:!0}),this.monster.cache.templates["operator-pro"]._main["pro-quickcall-popover-entity"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,a,i){var l,r=t.lambda,o=t.escapeExpression;return'<div class="quickcall-entity-popover">\n\t<div class="field-title">'+o(r(null!=(l=null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.pro:l)?l.quickCallPopover:l)?l.device:l,e))+'</div>\n\n\t<ul class="devices-list empty clearfix">\n\t\t<li class="empty">\n\t\t\t'+o(r(null!=(l=null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.pro:l)?l.quickCallPopover:l)?l.noDevices:l,e))+"\n\t\t</li>\n\t</ul>\n</div>"},useData:!0}),this.monster.cache.templates["operator-pro"]._main["pro-quickcall-popover"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(t,e,n,a,i){var l,r=t.lambda,o=t.escapeExpression;return'<div class="quickcall-popover-content">\n\t<div class="number-to-call">\n\t\t<div class="field-title">'+o(r(null!=(l=null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.pro:l)?l.quickCallPopover:l)?l.number:l,e))+'</div>\n\t\t<div class="field-content">\n\t\t\t<input id="quickcall_number" type="text">\n\t\t\t<button class="monster-button-fit dialpad-quickcall"><i class="icon-telicon-apps"></i></button>\n\t\t</div>\n\t</div>\n\n\t<div class="device-to-call-with">\n\t\t<div class="field-title">'+o(r(null!=(l=null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.pro:l)?l.quickCallPopover:l)?l.device:l,e))+'</div>\n\n\t\t<ul class="devices-list empty clearfix">\n\t\t\t<li class="empty">\n\t\t\t\t'+o(r(null!=(l=null!=(l=null!=(l=null!=(l=null!=e?e.i18n:e)?l.operatorApp:l)?l.pro:l)?l.quickCallPopover:l)?l.noDevices:l,e))+"\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n</div>"},useData:!0}),define("apps/operator-pro/submodules/pro/pro",["require","jquery","lodash","monster","toastr"],function(t){var e=t("jquery"),n=t("lodash"),a=t("monster"),i=t("toastr");return{requests:{},subscribe:{},hasProVersion:!0,proBindBottomBarEvents:function(t){var n=this,l=t.container,r=l.find(".bottom-bar");r.find(".feature").on("click",function(){var t=e(this);t.hasClass("filled")?t.toggleClass("active-fill"):["mute","hold"].indexOf(t.data("feature"))<0&&t.toggleClass("active")}),r.find('.feature[data-feature="mute"]').on("click",function(){var t=e(this);t.hasClass("active")?a.webphone.unmute():a.webphone.mute(),t.toggleClass("active")}),r.find('.feature[data-feature="hold"]').on("click",function(){e(this).hasClass("active")?a.webphone.unhold():a.webphone.hold()}),r.find(".hangup").on("click",function(){a.webphone.hangup()}),r.find(".toggle-webphone .monster-switch .switch-state").on("change",function(l){var r=e(this),o=e(this).parents(".monster-switch");o.hasClass("disabled")?r.prop("checked",!r.prop("checked")):(o.addClass("disabled"),r.prop("checked")?a.webphone.login({onConnected:function(t){r.prop("checked",!0),r.parents(".monster-switch").removeClass("disabled"),t.isWebphone=!0,t.cssClass="icon-telicon-soft-phone",n.proAddWebphoneToList(t),i.success(n.i18n.active().operatorApp.pro.webphoneConnected)},onError:function(){i.error(n.i18n.active().operatorApp.pro.noWebphoneAllowed),r.prop("checked",!1),r.parents(".monster-switch").removeClass("disabled"),n.proRemoveWebphonesFromList()},onIncoming:function(i){var l={deviceId:a.webphone.device.id,formatted:{callId:i.callId,callee:{label:a.webphone.device.name,id:a.webphone.device.id},caller:{label:i.callerName},direction:"inbound",elapsedTime:0,event:"ringing",isWebphone:!0,webphone:{countActiveCalls:a.webphone.listCalls().length,call:i,callbacks:{triggerAccept:function(){i.accept(),n.proRefreshWebphoneCalls()},triggerReject:function(){i.reject(),n.proRefreshWebphoneCalls()}}}}},r=e.extend({},t,{data:l});a.pub("operator.paintCall",r)},onHangup:function(){n.proRefreshWebphoneCalls()},onCancel:function(){n.proRefreshWebphoneCalls()},onAccepted:function(){n.proRefreshWebphoneCalls()},onHold:function(){n.proRefreshWebphoneCalls()},onUnhold:function(){n.proRefreshWebphoneCalls()}}):(n.proDisconnectWebphone(),o.removeClass("disabled")))})},proRefreshWebphoneCalls:function(t){var n=this,i=t||e(".operator-app-container .bottom-bar"),l=i.find(".webphone-actions"),r=a.webphone.getActiveCall();r?(!function(t){var e=t.find(".webphone-actions");e.removeClass("ringing"),e.show(),t.find(".quickcall-button").hide()}(i),"ringing"===r.status?(l.find(".timer").hide(),l.find(".ringing-text").show()):(l.find(".ringing-text").hide(),l.find(".timer").show(),function(t){n.appFlags.hasOwnProperty("proBottomBarTimer")&&n.appFlags.proBottomBarTimer&&clearInterval(n.appFlags.proBottomBarTimer);var e=a.ui.timer(l.find(".timer"),t);n.appFlags.proBottomBarTimer=e}(r.acceptedDuration)),i.find(".phone-number").html(r.callerIdName),i.find('[data-feature="hold"]').toggleClass("active",r.isOnHold),i.find('[data-feature="mute"]').toggleClass("active",r.isMuted)):function(t){var n=t.find(".webphone-actions");n.removeClass("ringing"),n.find(".feature").removeClass("active active-fill"),e(".oncall-dialpad-popover").removeClass("drop-open"),t.find(".quickcall-button").show(),n.hide()}(i)},proAddCallToBottomBar:function(){var t=e(".operator-app-container .bottom-bar"),n=t.find(".webphone-actions");!function(t){var e=t.find(".webphone-actions");e.removeClass("ringing"),e.show(),t.find(".quickcall-button").hide()}(t),a.ui.timer(n.find(".timer"),0)},proAddWebphoneToList:function(t){var n=this,i=e(".quickcall-popover-content").find(".devices-list");n.appFlags.availableDevices.push(t),i.append(a.template(n,"pro-quickcall-device",t)),i.removeClass("empty")},proDisconnectWebphone:function(){this.proRemoveWebphonesFromList(),a.webphone.logout()},proRemoveWebphonesFromList:function(){var t=this,a=e(".quickcall-popover-content").find(".devices-list"),i=[];n.each(t.appFlags.availableDevices,function(t){t.hasOwnProperty("isWebphone")&&t.isWebphone||i.push(t)}),t.appFlags.availableDevices=i,a.find(".device.webphone").remove(),0===a.find("li:not(.empty)").length&&a.addClass("empty")},proPaintCallDevices:function(t){var e=this,i=e.appFlags.availableDevices;i.length?(t.removeClass("empty"),n.each(i,function(n){t.append(a.template(e,"pro-quickcall-device",n))})):t.addClass("empty")},proDialpadOnCallPopover:function(t){var e=a.ui.dialpad({onDtmfClick:function(t,e){a.webphone.sendDTMF(t)}});a.ui.popover({target:t.find('.action-block[data-feature="dialpad"]'),content:e,dropOptions:{classes:"oncall-dialpad-popover",tetherOptions:{attachment:"bottom center",targetAttachment:"top center"}}}).on("close",function(){e.find(".dialbox").val("")})},proPlaceCall:function(t,n,l){var r=this,o=t.hasClass("webphone"),s=e("#operator_app_container");o?(a.webphone.connect(n),s.find(".webphone-actions .phone-number").html(n),s.find(".webphone-actions").show(),s.find(".quickcall-button").hide(),s.find(".webphone-actions").addClass("ringing"),e(".tooltip").hide(),i.success(a.template(r,"!"+r.i18n.active().operatorApp.pro.quickCallPopover.successConnect,{device:t.data("name"),destination:n})),l&&l()):r.proPlaceQuickCall(t.data("id"),n,function(e){i.success(a.template(r,"!"+r.i18n.active().operatorApp.pro.quickCallPopover.successConnect,{device:t.data("name"),destination:n})),l()})},proQuickCallPopover:function(t,n){var i,l=this,r=e(a.template(l,"pro-quickcall-popover"));a.ui.tooltips(r,{options:{container:"body"}}),l.proPaintCallDevices(r.find(".devices-list")),r.find(".devices-list").on("click",".device",function(){var t=r.find("#quickcall_number");l.proPlaceCall(e(this),t.val(),function(){t.val(""),i.close()})});var o=a.ui.dialpad({onDtmfClick:function(t,e){r.find("#quickcall_number").val(e)},onBackSpaceClick:function(t){r.find("#quickcall_number").val(t)}});r.find(".dialpad-quickcall").on("click",function(){o.find(".dialbox").val(r.find("#quickcall_number").val())}),a.ui.popover({removeTarget:t.find(".quickcall-button"),target:r.find(".dialpad-quickcall"),content:o,dropOptions:{classes:"dialpad-quickcall-popover",tetherOptions:{targetAttachment:"middle right",attachment:"middle left"}}}),i=a.ui.popover({target:t.find(".quickcall-button"),title:l.i18n.active().operatorApp.pro.quickCallPopover.title,content:r,dropOptions:{openOn:"always",remove:!1,classes:"open-quickcall-popover",tetherOptions:{targetAttachment:"top left",attachment:"bottom left"}}});var s=!0;i.on("open",function(){s&&(s=!1,i.close())}),t.find(".quickcall-button").on("click",function(){i.toggle()})},proPaintMainTemplate:function(t,n){var i=this,l={hasWebphone:a.config.api.hasOwnProperty("socketWebphone"),isWebphoneConnected:a.webphone.isConnected()},r=e(a.template(i,"pro-bottom-bar",l));t.addClass("pro-version"),i.proQuickCallPopover(r,n),i.proDialpadOnCallPopover(r),a.ui.tooltips(r,{options:{container:"body"}}),t.append(r),i.proRefreshWebphoneCalls(r)},proAfterShowOverlay:function(){e("#operator_app_container .bottom-bar").addClass("overlay-on"),e(".powered-by, #atlwdg-trigger").hide()},proAfterRemoveOverlay:function(){var t=this;e(".feature-activated").removeClass("feature-activated"),e(".is-transfering").removeClass("is-transfering"),e(".is-parking").removeClass("is-parking"),e(".is-retrieving").removeClass("is-retrieving"),delete t.appFlags.transfer,delete t.appFlags.unpark,delete t.appFlags.park,e("#operator_app_container .bottom-bar").removeClass("overlay-on"),e(".powered-by, #atlwdg-trigger").show()},proAddEntityActions:function(t){var n=this,i=e("#operator_app_container"),l=e(a.template(n,"pro-actions-entities")),r={cssToExclude:t,afterShow:function(){n.proAfterShowOverlay()},afterHide:function(){n.proAfterRemoveOverlay()}};t.on("click",function(l){n.appFlags.hasOwnProperty("transfer")?n.proTransferChannel(n.appFlags.transfer.channel,t.data("presence-id"),r):n.appFlags.hasOwnProperty("unpark")?n.proUnparkChannel(n.appFlags.unpark.channel,t.data("presence-id"),r):t.hasClass("action-state")||e(l.target).hasClass("cancel")||(i.find(".entities-listing .action-state").removeClass("action-state"),t.addClass("action-state"),a.ui.overlay.show(r))}),l.find(".cancel").on("click",function(e){t.removeClass("action-state"),a.ui.overlay.hide(r)}),l.find(".call").on("click",function(e){n.proShowPopoverQuickCallEntity(t,t.data("presence-id"))}),t.append(l)},proGetCallEntityTemplate:function(t){var n=this,i=e(a.template(n,"pro-quickcall-popover-entity"));return n.proPaintCallDevices(i.find(".devices-list")),a.ui.tooltips(i,{options:{container:"body"}}),i},proShowPopoverQuickCallEntity:function(t,n){var i,l=this,r=l.proGetCallEntityTemplate();r.find(".devices-list .device").on("click",function(){l.proPlaceCall(e(this),n,function(){t.removeClass("action-state"),i.close()})}),i=a.ui.popover({target:t.find(".call"),content:r,mode:"showOnceOnClick",dropOptions:{classes:"call-device-popover",tetherOptions:{attachment:"bottom center",targetAttachment:"top center"}}})},proPlaceQuickCall:function(t,e,n){var a=this;e?a.callApi({resource:"device.quickcall",data:{accountId:a.accountId,deviceId:t,number:e},success:function(t){n&&n(t)}}):i.error(a.i18n.active().operatorApp.pro.quickCallPopover.invalidQuickcallNumber)},proGetRegisteredDevices:function(t){var e=this;e.callApi({resource:"device.getStatus",data:{accountId:e.accountId},success:function(e){t&&t(e.data)}})},proGetUserDevices:function(t){var e=this;e.callApi({resource:"device.list",data:{accountId:e.accountId,filters:{filter_owner_id:e.userId}},success:function(e){t&&t(e.data)}})},proGetDashboardData:function(t,e){var n=this;a.parallel({devices:function(t){n.proGetUserDevices(function(e){t&&t(null,e)})},status:function(t){n.proGetRegisteredDevices(function(e){t&&t(null,e)})},userWebphones:function(t){a.pub("common.webphone.getUserDevices",function(e){t&&t(null,e)})}},function(a,i){var l=n.proFormatDashboardData(i);n.appFlags.availableDevices=l.devices,t.proData=l,e&&e(t)})},proFormatDashboardData:function(t){var e,i=n.keyBy(t.status,"device_id"),l=n.keyBy(t.userWebphones,"id"),r=[],o={},s=a.webphone.isConnected(),c={cellphone:"fa fa-phone",smartphone:"icon-telicon-mobile-phone",landline:"icon-telicon-home",mobile:"icon-telicon-sprint-phone",softphone:"icon-telicon-soft-phone",sip_device:"icon-telicon-voip-phone",sip_uri:"icon-telicon-voip-phone",fax:"icon-telicon-fax",ata:"icon-telicon-ata"};return n.each(t.devices,function(t){e=l.hasOwnProperty(t.id),e?(t.isWebphone=!0,t.cssClass="icon-telicon-soft-phone"):t.cssClass=c[t.device_type],!i.hasOwnProperty(t.id)||e&&!s||r.push(t)}),o.devices=r,o},proRenderCallElementActions:function(t,n){var i,l,r,o=this,s=e(a.template(o,"pro-call-element-actions",{data:n})),c=t.data("id");return s.find('[data-action="retrieve"]').on("click",function(){a.webphone.holdAll(),a.webphone.unhold(c)}),s.find('[data-action="pickup"]').on("click",function(){n.hasOwnProperty("webphone")&&n.webphone.callbacks.triggerAccept()}),s.find('[data-action="hold-accept"]').on("click",function(){n.hasOwnProperty("webphone")&&(a.webphone.holdAll(c),n.webphone.callbacks.triggerAccept())}),s.find('[data-action="hangup-accept"]').on("click",function(){n.hasOwnProperty("webphone")&&(a.webphone.hangupAll(c),n.webphone.callbacks.triggerAccept())}),s.find('[data-action="ignore"]').on("click",function(){n.hasOwnProperty("webphone")&&(n.webphone.callbacks.triggerReject(),e('.call-element[data-id="'+c+'"]').remove())}),s.find('[data-action="hangup"]').on("click",function(){t.hasClass("feature-activated")||o.proHangupChannel(c)}),s.find('[data-action="hold"]').on("click",function(){if(!t.hasClass("feature-activated")){var n=e(this);o.proToggleHoldChannel(c),n.toggleClass("active"),n.parents(".call-element").toggleClass("hold").find(".status-label")}}),s.find('[data-action="transfer"]').on("click",function(){var n={cssToExclude:[e(this).parents(".call-element"),e(".call-transfer-popover"),e("#entities")],afterShow:function(){o.appFlags.transfer={channel:c,popover:i},o.proAfterShowOverlay()},afterHide:function(){o.proAfterRemoveOverlay()},onClick:function(){i.toggle()}};t.hasClass("is-transfering")?(i.close(),a.ui.overlay.hide(n)):t.hasClass("feature-activated")||(i?i.open():i=o.proTransferPopover(e(this),c,n),t.addClass("feature-activated is-transfering"),a.ui.overlay.show(n))}),s.find('[data-action="unpark"]').on("click",function(){var n={cssToExclude:[e(this).parents(".call-element"),e(".call-unpark-popover"),e("#entities")],afterShow:function(){o.appFlags.unpark={channel:c,popover:l},o.proAfterShowOverlay()},afterHide:function(){o.proAfterRemoveOverlay()},onClick:function(){l.toggle()}};t.hasClass("is-retrieving")?(l.close(),a.ui.overlay.hide(n)):t.hasClass("feature-activated")||(l?l.open():l=o.proUnparkPopover(e(this),c,n),t.addClass("feature-activated is-retrieving"),a.ui.overlay.show(n))}),s.find('[data-action="park"]').on("click",function(){var n={cssToExclude:[e(this).parents(".call-element"),e(".call-park-popover")],afterShow:function(){o.appFlags.park={channel:c,popover:r},o.proAfterShowOverlay()},afterHide:function(){o.proAfterRemoveOverlay()},onClick:function(){r.toggle()}};t.hasClass("is-parking")?(r.close(),a.ui.overlay.hide(n)):t.hasClass("feature-activated")||(t.addClass("feature-activated is-parking"),a.ui.overlay.show(n),r?r.open():r=o.proParkPopover(e(this),c,n))}),t.append(s),t.find(".call-element-content").on("click",function(t){if(!e(this).parents(".feature-activated").length){var n=e(this),a=n.parent(".call-element").hasClass("selected");t.preventDefault(),n.parents("section").find(".call-element").removeClass("selected"),n.parent(".call-element").toggleClass("selected",!a)}}),t},proTransferPopover:function(t,e,n){var i=this,l=a.ui.dialpad({button:{text:i.i18n.active().operatorApp.pro.transfer,class:"monster-button-success",onClick:function(t){i.proTransferChannel(e,t,n)}}});return a.ui.popover({target:t,content:l,dropOptions:{classes:"call-transfer-popover",openOn:"always",remove:!1,tetherOptions:{attachment:"top left",targetAttachment:"bottom left"}}})},proUnparkPopover:function(t,e,n){var i=this,l=a.ui.dialpad({button:{text:i.i18n.active().operatorApp.pro.retrieve,class:"monster-button-success",onClick:function(t){i.proUnparkChannel(e,t,n)}}});return a.ui.popover({target:t,content:l,dropOptions:{classes:"call-unpark-popover",openOn:"always",remove:!1,tetherOptions:{attachment:"top left",targetAttachment:"bottom left"}}})},proParkPopover:function(t,e,n){var i=this,l=a.ui.dialpad({headline:i.i18n.active().operatorApp.pro.parkingPopover.headline,hideKeys:!0,button:{text:i.i18n.active().operatorApp.pro.parkingPopover.park,class:"monster-button-warning",onClick:function(t){i.proParkChannel(e,t),r.close(),a.ui.overlay.hide(n)}}}),r=a.ui.popover({target:t,content:l,dropOptions:{classes:"call-park-popover",openOn:"always",remove:!1,tetherOptions:{attachment:"top left",targetAttachment:"bottom left"}}});return r},proTransferChannel:function(t,e,n,i){var l=this,r={module:"transfer",data:{target:e+="","Transfer-Type":"blind",leg:"bleg"}};l.appFlags.transfer.popover.close(),l.proActionChannel(t,r,i),a.ui.overlay.hide(n)},proParkChannel:function(t,e,n){var a=this,i={module:"transfer",data:{target:"*3"+e,"Transfer-Type":"blind",leg:"bleg"}};a.proActionChannel(t,i,n)},proUnparkChannel:function(t,e,n,i){var l=this,r={module:"intercept",data:{target_type:"number",target_id:e+=""}};l.appFlags.unpark.popover.close(),l.proActionChannel(t,r,i),a.ui.overlay.hide(n)},proHangupChannel:function(t,e){var n=this,a={module:"hangup"};n.proActionChannel(t,a,e)},proTTSChannel:function(t,e){var n=this,a={module:"tts",data:{text:"you are awesome"}};n.proActionChannel(t,a,e)},proToggleHoldChannel:function(t,e){var n=this,a={module:"hold_control"};n.proActionChannel(t,a,e)},proActionChannel:function(t,e,n){var a=this;a.callApi({resource:"channel.action",data:{accountId:a.accountId,callId:t,data:e,envelopeKeys:{action:"metaflow"}},success:function(t){n&&n(t.data)}})}}});