define("apps/cdrs/app",["require","jquery","lodash","monster","chart","toastr","monster-timezone","moment"],function(t){var e=t("jquery"),a=t("lodash"),n=t("monster"),l=t("chart"),s=(t("toastr"),t("monster-timezone")),r=t("moment");return{css:["app"],i18n:{"en-US":{customCss:!1}},appFlags:{chartColor:["rgb(75, 192, 192)","rgb(255, 99, 132)","rgb(54, 162, 235)","rgb(255, 159, 64)","rgb(153, 102, 255)","rgb(255, 205, 86)","rgb(201, 203, 207)"],cdrs:{defaultRange:1,maxRange:31,timezone:n.apps.auth.currentAccount.timezone},devices:[]},requests:{},subscribe:{},load:function(t){var e=this;e.initApp(function(){t&&t(e)})},initApp:function(t){var e=this;n.pub("auth.initApp",{app:e,callback:t})},render:function(t){var e=this;n.ui.generateAppLayout(e,{menus:[{tabs:[{text:e.i18n.active().cdrs.title,callback:e.renderCDRs}]}]})},renderCDRs:function(t){var a=this,l=t||{},s=l.container||e("#cdrs_app_container .app-content-wrapper");a.cdrsGetData(function(t){var l=a.cdrsFormatData(t),r=e(n.template(a,"layout",l));a.cdrsInitDatePicker(r,s),n.ui.footable(r.find(".footable")),a.cdrsBindGlobalEvents(r),a.cdrsListRender(r,function(){s.fadeOut(function(){e(this).empty().append(r).fadeIn()})})})},cdrsBindGlobalEvents:function(t){var a=this,n=a.cdrsGetCurrentTimezone();t.find(".cdrs-tabs a").click(function(t){t.preventDefault(),e(this).parent().hasClass("disabled")||e(this).tab("show")}),t.find(".link-sub-nav").on("click",function(){var t=e(this),a=t.parents(".tab-pane");a.find(".link-sub-nav").removeClass("active"),a.find(".sub-tab-content").removeClass("active"),t.addClass("active"),a.find('.sub-tab-content[data-type="'+t.data("name")+'"]').addClass("active")}),t.find(".user-selected .close-user-view").on("click",function(){t.find(".user-view").removeClass("active"),t.find(".user-view.select-user-view").addClass("active"),t.find(".user-view.user-selected .sub-tab-content").empty(),t.find("#cdrs_user_tab").attr("data-selected-user","unset")}),t.find(".select-user-view").on("click",".user-row",function(){var n=e(this).data("id");t.find(".user-view").removeClass("active"),t.find(".user-view.user-selected").addClass("active"),a.cdrsListRenderUser(t,n)}),t.find(".fixed-ranges button").on("click",function(n){var l=e(this),s=l.data("type");if(!l.hasClass("disabled"))if(t.find(".fixed-ranges button").removeClass("active"),l.addClass("active"),"custom"!==s){var r=a.cdrsGetFixedDatesFromType(s);t.find(".custom-range").removeClass("active"),t.find("#startDate").datepicker("setDate",r.from),t.find("#endDate").datepicker("setDate",r.to),t.find(".fixed-ranges button").addClass("disabled"),a.cdrsRefreshView(t,function(){t.find(".fixed-ranges button").removeClass("disabled")})}else t.find(".custom-range").addClass("active")}),s.populateDropdown(t.find(".logs-timezone"),n),t.find(".logs-timezone").chosen({search_contains:!0,width:"220px"}),t.find(".logs-timezone").on("change",function(){a.appFlags.cdrs.timezone=e(this).val(),a.cdrsRefreshView(t)})},cdrsGetFixedDatesFromType:function(t){var e=new Date,a=new Date;if("thisWeek"===t){var n=e.getDay(),l=(n||7)-1;e.setDate(e.getDate()-l)}else"thisMonth"===t&&e.setDate(1);return{from:e,to:a}},cdrsListRenderUser:function(t,e,a){var l=this,s=t.find('#cdrs_user_tab .sub-tab-content[data-type="logs"]'),r=t.find('#cdrs_user_tab .sub-tab-content[data-type="dashboard"]'),i=t.find("input.filter-from").datepicker("getDate"),o=t.find("input.filter-to").datepicker("getDate"),d={created_from:n.util.dateToBeginningOfGregorianDay(i,l.cdrsGetCurrentTimezone()),created_to:n.util.dateToEndOfGregorianDay(o,l.cdrsGetCurrentTimezone()),paginate:!1};t.find("#cdrs_user_tab").attr("data-selected-user",e),s.empty(),r.empty(),l.cdrsListGetUserData(d,e,function(e){l.cdrsListDisplayTable(s,t,e,function(){l.cdrsListDisplayDashboard(r,e,function(){a&&a()})})})},cdrsInitDatePicker:function(t,a){var l=this,s=n.util.getDefaultRangeDates(l.appFlags.cdrs.defaultRange),r=s.from,i=s.to,o={container:t,range:l.appFlags.cdrs.maxRange};n.ui.initRangeDatepicker(o),t.find("#startDate").datepicker("setDate",r),t.find("#endDate").datepicker("setDate",i),t.find(".apply-filter").on("click",function(n){e(this).hasClass("disabled")||(t.find(".fixed-ranges button").addClass("disabled"),t.find(".apply-filter").addClass("disabled"),l.cdrsRefreshView(a,function(){t.find(".fixed-ranges button").removeClass("disabled"),t.find(".apply-filter").removeClass("disabled")}))})},cdrsRefreshView:function(t,e){var a=this,l=t.find("#cdrs_user_tab").attr("data-selected-user");n.parallel({renderCDRs:function(e){a.cdrsListRender(t,function(){e(null,null)})},renderUser:function(e){"unset"!==l?a.cdrsListRenderUser(t,l,function(){e(null,null)}):e(null,null)}},function(t,a){e&&e()})},cdrsListRender:function(t,e){var a=this,l=t.find('#cdrs_overall_tab .sub-tab-content[data-type="logs"]'),s=t.find('#cdrs_overall_tab .sub-tab-content[data-type="dashboard"]'),r=t.find("input.filter-from").datepicker("getDate"),i=t.find("input.filter-to").datepicker("getDate"),o={created_from:n.util.dateToBeginningOfGregorianDay(r,a.cdrsGetCurrentTimezone()),created_to:n.util.dateToEndOfGregorianDay(i,a.cdrsGetCurrentTimezone()),paginate:!1};l.empty(),s.empty(),a.cdrsListGetData(o,function(n){a.cdrsListDisplayTable(l,t,n,function(){a.cdrsListDisplayDashboard(s,n,function(){e&&e()})})})},cdrsListDisplayDashboard:function(t,e,l){var s=this,r=s.cdrsListFormatDashboardData(e),i=s.getPropertyStats(r.data,"direction"),o=s.getPropertyStatsPerHour(r.data,"hangup_cause",4,6),d=s.getDurationStats(r.data),c=s.getCostStats(r.data),u=s.getTotalCostPerProperty(r.data,"rate_name");t.empty().append(n.template(s,"cdrs-list-dashboard",r)),r.isEmptyRange||(s.createChart(t.find("#direction_pie_chart"),{type:"pie",data:{datasets:[{data:i.datasets[0].data,backgroundColor:a.map(i.labels,function(t,e){return s.appFlags.chartColor[e]})}],labels:i.labels},options:{title:{display:!0,text:s.i18n.active().cdrs.dashboard.titles.inboundVsOutbound},legend:{display:!1},tooltips:{callbacks:{label:function(t,e){var n=e.datasets[t.datasetIndex],l=a.reduce(n.data,function(t,e){return t+e},0),s=n.data[t.index],r=Math.floor(s/l*100+.5);return e.labels[t.index]+": "+r+"%"}}}}}),s.createChart(t.find("#hangup_cause_bar_chart"),{type:"bar",data:{datasets:a.map(o.datasets,function(t,e){return{data:t.data,label:t.label,backgroundColor:s.appFlags.chartColor[e]}}),labels:o.labels},options:{maintainAspectRatio:!1,title:{display:!0,text:s.i18n.active().cdrs.dashboard.titles.hangupCauses},scales:{xAxes:[{stacked:!0,scaleLabel:{display:!0,labelString:s.i18n.active().cdrs.dashboard.axes.periodOfDay}}],yAxes:[{stacked:!0,scaleLabel:{display:!0,labelString:s.i18n.active().cdrs.dashboard.axes.occurrences}}]}}}),s.renderStatsTable(t.find("#call_stats_table_wrapper"),{title:s.i18n.active().cdrs.dashboard.titles.callStatistics,rows:{totalCalls:e.data.length,avgDuration:d.avg,maxDuration:d.max,totalDuration:d.total,avgCost:s.i18n.active().currencyUsed+c.avg,maxCost:s.i18n.active().currencyUsed+c.max,totalCost:s.i18n.active().currencyUsed+c.total}}),s.renderStatsTable(t.find("#rate_stats_table_wrapper"),{title:s.i18n.active().cdrs.dashboard.titles.totalCostPerRate,rows:a.map(u,function(t){return{label:t.label,value:s.i18n.active().currencyUsed+t.value}})})),l&&l()},renderStatsTable:function(t,l){var s=this,r=function(t){return{title:t.title,data:a.isArray(t.rows)?t.rows:a.map(t.rows,function(t,e){return{label:s.i18n.active().cdrs.dashboard.rows[e],value:t}})}};t.append(function(t){var a=e(s.getTemplate({name:"cdrs-list-dashboard-statsTable",data:r(t)}));return n.ui.footable(a.find(".monster-table.footable"),{filtering:{enabled:!1}}),a}(l))},createChart:function(t,e){return new l(t,e)},getPropertyStats:function(t,e){var n={};return a.each(t,function(t){n.hasOwnProperty(t[e])||(n[t[e]]=0),n[t[e]]++}),n=a.chain(n).map(function(t,e){return{label:e,value:t}}).sortBy("value").value().reverse(),{labels:a.map(n,"label"),datasets:[{data:a.map(n,"value")}]}},getPropertyStatsPerHour:function(t,e,l,s){var i,o,d,c=this,u=Math.floor(l)||1,p=s||0,f=a.chain(24/u).range().map(function(t){return t*u}).value(),m={},h=function(t){var e=!(!n.apps.auth.currentUser.ui_flags||!n.apps.auth.currentUser.ui_flags.twelve_hours_mode),a=e?"hh:mm A":"HH:mm";return r(t+"0000","Hmmss").format(a)},v=a.map(f,function(t,e,a){return[h(t),h(a[e+1]?a[e+1]:a[0])]});return a.each(t,function(t){d=r.tz(1e3*t.unix_timestamp,c.cdrsGetCurrentTimezone()).get("h"),o=t[e],m.hasOwnProperty(o)||(m[o]=a.map(f,function(){return 0})),a.each(f,function(t,e){d>=t&&d<t+u&&m[o][e]++})}),p&&(i=a.chain(m).map(function(t,e){return{key:e,count:a.reduce(t,function(t,e){return t+e},0)}}).sortBy("count").value().reverse().slice(0,p).map(function(t){return t.key}),a.each(m,function(t,e){i.indexOf(e)<0&&delete m[e]})),{labels:v,datasets:a.chain(m).map(function(t,e){return{label:e,data:t}}).sortBy(function(t){return a.reduce(t.data,function(t,e){return t+e},0)}).value().reverse()}},getDurationStats:function(t){var e=0,l=a.map(t,function(t){var a=parseInt(t.duration_seconds,10);return e+=a,a});return{total:n.util.friendlyTimer(e),avg:n.util.friendlyTimer(Math.round(e/l.length)),max:n.util.friendlyTimer(a.max(l)),min:n.util.friendlyTimer(a.min(l))}},getCostStats:function(t,e){var n=0,l=Math.pow(10,e||2),s=a.map(t,function(t){var e=parseInt(t.billing_seconds,10)/60*parseFloat(t.rate,10);return n+=e,e});return{total:(Math.round(n*l)/l).toFixed(2),avg:(Math.round(n/s.length*l)/l).toFixed(2),max:(Math.round(a.max(s)*l)/l).toFixed(2),min:1}},getTotalCostPerProperty:function(t,e){var n,l=this,s={};return a.each(t,function(t){n=t[e],""===n&&(n="UNDEFINED"),s.hasOwnProperty(n)||(s[n]=[]),s[n].push(t)}),a.each(s,function(t,e,a){a[e]=l.getCostStats(t).total}),a.chain(s).map(function(t,e){return{label:e,value:t}}).sortBy("value").value().reverse()},cdrsListFormatDashboardData:function(t){var e={data:t.data,isEmptyRange:0===(t.data||[]).length};return a.each(e.data,function(t){t.hasOwnProperty("authorizing_id")&&""!==t.authorizing_id?t.direction="outbound":t.direction="inbound"}),e},cdrsGetCurrentTimezone:function(){return this.appFlags.cdrs.timezone},cdrsListDisplayTable:function(t,a,l,s,r){var i=this,o=a.find("input.filter-from").datepicker("getDate"),d=a.find("input.filter-to").datepicker("getDate"),c=!0===r;t.append(n.template(i,"cdrs-list-table",{hideDownload:c,isLegsTable:c})),n.ui.footable(t.find(".footable"),{getData:function(t,s){t=e.extend(!0,t,{pagination:!1,created_from:n.util.dateToBeginningOfGregorianDay(o,i.cdrsGetCurrentTimezone()),created_to:n.util.dateToEndOfGregorianDay(d,i.cdrsGetCurrentTimezone())}),i.cdrsListGetRows(a,t,l,s,c)},backendPagination:{enabled:!1},afterInitialized:function(e){i.cdrsListTableBindEvents(t,a,e),s&&s()}})},cdrsListTableBindEvents:function(t,a,l){var s=this;n.ui.tooltips(t.find(".footable")),t.find(".footable").on("click",".details-cdr",function(){s.cdrsListShowDetails(e(this).parents(".cdr-row").data("id"))}),t.find(".footable").on("click",".interactions-cdr",function(){s.cdrsListShowInteractions(e(this).parents(".cdr-row").data("id"),a)}),l.internalCdrs>0?(t.find(".internal-filter-wrapper .filter-count").text(l.internalCdrs),t.find("#show_internal_cdrs").on("change",function(){s.legsFilterTable(t)})):t.find(".internal-filter-wrapper").hide(),t.find(".download-csv").on("click",function(t){var e=a.find("input.filter-from").datepicker("getDate"),l=a.find("input.filter-to").datepicker("getDate"),r=n.util.dateToBeginningOfGregorianDay(e),i=n.util.dateToEndOfGregorianDay(l),o=a.find("#cdrs_user_tab").attr("data-selected-user"),d=s.apiUrl+"accounts/"+s.accountId+"/users/"+o+"/cdrs?created_from="+r+"&created_to="+i+"&paginate=false&accept=text/csv&auth_token="+s.getAuthToken(),c=s.apiUrl+"accounts/"+s.accountId+"/cdrs?created_from="+r+"&created_to="+i+"&accept=text/csv&paginate=false&auth_token="+s.getAuthToken();"overall"===a.find(".tab-pane.active").data("type")?window.open(c,"_blank"):window.open(d,"_blank")})},cdrsListShowDetails:function(t){var a=this;a.cdrsListGetDetails(t,function(t){var l=e(a.getTemplate({name:"cdrs-list-details-dialog"}));n.ui.renderJSON(t,l.find("#jsoneditor")),n.ui.dialog(l,{title:a.i18n.active().cdrs.cdrsDetailDialog.title,position:["center",20]})})},cdrsListShowInteractions:function(t,a){var l=this;l.cdrsListGetLegs(t,function(t){var s=e(l.getTemplate({name:"cdrs-list-interactions-dialog"}));l.cdrsListDisplayTable(s.find(".table-container"),a,t,function(){var t=n.ui.dialog(s,{title:l.i18n.active().cdrs.cdrsInteractionsDialog.title,position:["center",20]});l.legsFilterTable(t)},!0)})},cdrsListGetRows:function(t,a,l,s,r){var i=this,o=function(a){var l=i.cdrsListFormatDataTable(a,t,r),o=e(n.template(i,"cdrs-list-rows",l));s&&s(o,a,l)};l?o(l):i.cdrsListGetData(a,function(t){o(t)})},legsFilterTable:function(t){var e=!t.find("#show_internal_cdrs").is(":checked"),a=FooTable.get("#cdrs_list_legs_table").use(FooTable.Filtering);e?a.addFilter("internal","false",[1]):a.removeFilter("internal"),a.filter()},cdrsListFormatDataTable:function(t,e,l){var s,r,i=this,o=i.cdrsGetCurrentTimezone(e),d={isLegs:l,cdrs:t.data,internalCdrs:0},c=i.i18n.active().hangupCauses,u={cellphone:"fa fa-phone",smartphone:"icon-telicon-mobile-phone",landline:"icon-telicon-home",mobile:"icon-telicon-sprint-phone",softphone:"icon-telicon-soft-phone",sip_device:"icon-telicon-voip-phone",sip_uri:"icon-telicon-voip-phone",fax:"icon-telicon-fax",ata:"icon-telicon-ata",unknown:"fa fa-circle"};return a.each(d.cdrs,function(t){if(s="",r=l?"outbound"===t.call_direction:t.hasOwnProperty("authorizing_id")&&t.authorizing_id.length>0,c.hasOwnProperty(t.hangup_cause)&&(r&&c[t.hangup_cause].hasOwnProperty("outbound")?s+=c[t.hangup_cause].outbound:!r&&c[t.hangup_cause].hasOwnProperty("inbound")&&(s+=c[t.hangup_cause].inbound)),t.formatted={date:n.util.toFriendlyDate(t.timestamp,"date",void 0,!0,o),time:n.util.toFriendlyDate(t.timestamp,"time",void 0,!0,o),duration:n.util.friendlyTimer(t.duration_seconds),fromName:t.caller_id_name,fromNumber:t.caller_id_number||t.from.replace(/@.*/,""),toName:t.callee_id_name,toNumber:t.callee_id_number||(t.hasOwnProperty("request")?t.request.replace(/@.*/,""):t.to.replace(/@.*/,"")),hangupCause:t.hangup_cause,hangupHelp:s,isOutboundCall:r},l&&(t.formatted.isInternal=!!t.hasOwnProperty("channel_is_loopback")&&t.channel_is_loopback,t.formatted.isInternal&&d.internalCdrs++,t.hasOwnProperty("custom_channel_vars")&&t.custom_channel_vars.hasOwnProperty("authorizing_id")&&i.appFlags.devices.hasOwnProperty(t.custom_channel_vars.authorizing_id))){var e=i.appFlags.devices[t.custom_channel_vars.authorizing_id];t.formatted.deviceIcon=u[e.device_type],t.formatted.deviceTooltip=i.i18n.active().cdrs.cdrsList.deviceTypes[e.device_type],"inbound"===t.call_direction?t.formatted.fromDeviceName=e.name:t.formatted.toDeviceName=e.name}}),d},cdrsFormatData:function(t){var e=this,n={users:t.users,currentTimezone:e.cdrsGetCurrentTimezone()};return a.each(n.users,function(t){t.formatted={},t.formatted.friendlyName=t.first_name+" "+t.last_name}),n},cdrsGetData:function(t){var e=this;n.parallel({devices:function(t){e.cdrsListDevices(function(n){e.appFlags.devices=a.keyBy(n,"id"),t&&t(null,n)})},users:function(t){e.cdrsListUser(function(e){t&&t(null,e)})}},function(e,a){t&&t(a)})},cdrsListDevices:function(t){var e=this;e.callApi({resource:"device.list",data:{accountId:e.accountId,filters:{paginate:!1}},success:function(e,a){t(e.data)}})},cdrsListUser:function(t){var e=this;e.callApi({resource:"user.list",data:{accountId:e.accountId,filters:{paginate:!1}},success:function(e,a){t(e.data)}})},cdrsListGetUserData:function(t,e,a){var n=this;n.callApi({resource:"cdrs.listByInteractionUser",data:{accountId:n.accountId,userId:e,filters:t},success:function(t,e){a(t)}})},cdrsListGetData:function(t,e){var a=this;a.callApi({resource:"cdrs.listByInteraction",data:{accountId:a.accountId,filters:t},success:function(t,a){e(t)}})},cdrsListGetLegs:function(t,e){var a=this;a.callApi({resource:"cdrs.listLegs",data:{accountId:a.accountId,callId:t},success:function(t){e&&e(t)}})},cdrsListGetDetails:function(t,e){var a=this;a.callApi({resource:"cdrs.get",data:{accountId:a.accountId,cdrId:t},success:function(t,a){e&&e(t.data)}})}}}),this.monster=this.monster||{},this.monster.cache=this.monster.cache||{},this.monster.cache.templates=this.monster.cache.templates||{},this.monster.cache.templates.cdrs=this.monster.cache.templates.cdrs||{},this.monster.cache.templates.cdrs._main=this.monster.cache.templates.cdrs._main||{},this.monster.cache.templates.cdrs._main["cdrs-list-dashboard-statsTable"]=Handlebars.template({1:function(t,e,a,n,l){var s,r=null!=e?e:t.nullContext||{},i=a.helperMissing,o=t.escapeExpression;return"\t\t<tr>\n\t\t\t<td>\n\t\t\t\t"+o((s=null!=(s=a.label||(null!=e?e.label:e))?s:i,"function"==typeof s?s.call(r,{name:"label",hash:{},data:l}):s))+"\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t\t"+o((s=null!=(s=a.value||(null!=e?e.value:e))?s:i,"function"==typeof s?s.call(r,{name:"value",hash:{},data:l}):s))+"\n\t\t\t</td>\n\t\t</tr>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,a,n,l){var s,r,i=null!=e?e:t.nullContext||{};return'<div class="stats-table">\n\t<header>\n\t\t'+t.escapeExpression((r=null!=(r=a.title||(null!=e?e.title:e))?r:a.helperMissing,"function"==typeof r?r.call(i,{name:"title",hash:{},data:l}):r))+'\n\t</header>\n\t<table class="monster-table monster-table-skinny footable stats-table-no-header">\n'+(null!=(s=a.each.call(i,null!=e?e.data:e,{name:"each",hash:{},fn:t.program(1,l,0),inverse:t.noop,data:l}))?s:"")+"\t</table>\n</div>\n"},useData:!0}),this.monster.cache.templates.cdrs._main["cdrs-list-dashboard"]=Handlebars.template({1:function(t,e,a,n,l){return'\t\t<div class="canvas-wrapper" id="direction_pie_chart_wrapper">\n\t\t\t<canvas id="direction_pie_chart"></canvas>\n\t\t</div>\n\t\t<div class="canvas-wrapper" id="hangup_cause_bar_chart_wrapper">\n\t\t\t<canvas id="hangup_cause_bar_chart"></canvas>\n\t\t</div>\n\t\t<div class="stats-table-wrapper" id="call_stats_table_wrapper"></div>\n\t\t<div class="stats-table-wrapper" id="rate_stats_table_wrapper"></div>\n'},3:function(t,e,a,n,l){var s;return'\t\t<div class="empty-range-container">\n\t\t\t'+t.escapeExpression(t.lambda(null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.dashboard:s)?s.empty:s,e))+"\n\t\t</div>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,a,n,l){var s;return'<div class="dashboard-wrapper">\n'+(null!=(s=a.unless.call(null!=e?e:t.nullContext||{},null!=e?e.isEmptyRange:e,{name:"unless",hash:{},fn:t.program(1,l,0),inverse:t.program(3,l,0),data:l}))?s:"")+"</div>\n"},useData:!0}),this.monster.cache.templates.cdrs._main["cdrs-list-details-dialog"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(t,e,a,n,l){return'<div id="cdrs_details_dialog">\n\t<div id="jsoneditor">\n\t</div>\n</div>'},useData:!0}),this.monster.cache.templates.cdrs._main["cdrs-list-interactions-dialog"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(t,e,a,n,l){return'<div id="cdrs_interactions_dialog">\n\t<div class="table-container"></div>\n</div>'},useData:!0}),this.monster.cache.templates.cdrs._main["cdrs-list-rows"]=Handlebars.template({1:function(t,e,a,n,l){var s,r,i=null!=e?e:t.nullContext||{},o=a.helperMissing,d=t.escapeExpression,c=t.lambda;return'\t<tr class="cdr-row'+(null!=(s=a.if.call(i,null!=(s=null!=e?e.formatted:e)?s.isInternal:s,{name:"if",hash:{},fn:t.program(2,l,0),inverse:t.noop,data:l}))?s:"")+'" data-id="'+d((r=null!=(r=a.id||(null!=e?e.id:e))?r:o,"function"==typeof r?r.call(i,{name:"id",hash:{},data:l}):r))+'">\n\t\t<td>\n'+(null!=(s=a.if.call(i,null!=(s=null!=e?e.formatted:e)?s.isOutboundCall:s,{name:"if",hash:{},fn:t.program(4,l,0),inverse:t.program(6,l,0),data:l}))?s:"")+'\t\t</td>\n\t\t<td data-filter-value="'+d(c(null!=(s=null!=e?e.formatted:e)?s.isInternal:s,e))+'">\n\t\t\t'+d(c(null!=(s=null!=e?e.formatted:e)?s.isInternal:s,e))+'\n\t\t</td>\n\t\t<td class="timestamp-cell" data-timestamp="'+d((r=null!=(r=a.timestamp||(null!=e?e.timestamp:e))?r:o,"function"==typeof r?r.call(i,{name:"timestamp",hash:{},data:l}):r))+'">\n\t\t\t<div class="sub-cell cell-top">'+d(c(null!=(s=null!=e?e.formatted:e)?s.date:s,e))+'</div>\n\t\t\t<div class="sub-cell cell-bottom">'+d(c(null!=(s=null!=e?e.formatted:e)?s.time:s,e))+'</div>\n\t\t</td>\n\t\t<td class="'+(null!=(s=a.if.call(i,null!=(s=null!=e?e.formatted:e)?s.fromDeviceName:s,{name:"if",hash:{},fn:t.program(8,l,0),inverse:t.noop,data:l}))?s:"")+'">\n'+(null!=(s=a.if.call(i,null!=(s=null!=e?e.formatted:e)?s.fromName:s,{name:"if",hash:{},fn:t.program(10,l,0),inverse:t.program(13,l,0),data:l}))?s:"")+(null!=(s=a.if.call(i,null!=(s=null!=e?e.formatted:e)?s.fromDeviceName:s,{name:"if",hash:{},fn:t.program(15,l,0),inverse:t.noop,data:l}))?s:"")+'\t\t</td>\n\t\t<td class="'+(null!=(s=a.if.call(i,null!=(s=null!=e?e.formatted:e)?s.toDeviceName:s,{name:"if",hash:{},fn:t.program(8,l,0),inverse:t.noop,data:l}))?s:"")+'">\n'+(null!=(s=a.if.call(i,null!=(s=null!=e?e.formatted:e)?s.toName:s,{name:"if",hash:{},fn:t.program(17,l,0),inverse:t.program(19,l,0),data:l}))?s:"")+(null!=(s=a.if.call(i,null!=(s=null!=e?e.formatted:e)?s.toDeviceName:s,{name:"if",hash:{},fn:t.program(21,l,0),inverse:t.noop,data:l}))?s:"")+"\t\t</td>\n\t\t<td>"+d(c(null!=(s=null!=e?e.formatted:e)?s.duration:s,e))+'</td>\n\t\t<td>\n\t\t\t<span data-original-title="'+d(c(null!=(s=null!=e?e.formatted:e)?s.hangupHelp:s,e))+'" data-placement="top" data-toggle="tooltip" class="cause-title">'+d(c(null!=(s=null!=e?e.formatted:e)?s.hangupCause:s,e))+'</span>\n\t\t</td>\n\t\t<td class="actions-cdr">\n\t\t\t<i data-placement="top" data-toggle="tooltip" data-original-title="'+d(c((s=(s=(s=(s=(s=l&&l.root)&&s.i18n)&&s.cdrs)&&s.cdrsList)&&s.table)&&s.details,e))+'" class="details-cdr fa fa-eye"></i>\n'+(null!=(s=a.unless.call(i,(s=l&&l.root)&&s.isLegs,{name:"unless",hash:{},fn:t.program(23,l,0),inverse:t.noop,data:l}))?s:"")+"\t\t</td>\n\t</tr>\n"},2:function(t,e,a,n,l){return" internal"},4:function(t,e,a,n,l){var s;return'\t\t\t\t<i class="fa fa-arrow-left monster-orange" data-original-title="'+t.escapeExpression(t.lambda((s=(s=(s=(s=(s=l&&l.root)&&s.i18n)&&s.cdrs)&&s.cdrsList)&&s.table)&&s.outbound,e))+'" data-placement="top" data-toggle="tooltip"></i>\n'},6:function(t,e,a,n,l){var s;return'\t\t\t\t<i class="fa fa-arrow-right monster-green" data-original-title="'+t.escapeExpression(t.lambda((s=(s=(s=(s=(s=l&&l.root)&&s.i18n)&&s.cdrs)&&s.cdrsList)&&s.table)&&s.inbound,e))+'" data-placement="top" data-toggle="tooltip"></i>\n'},8:function(t,e,a,n,l){return"high-cell"},10:function(t,e,a,n,l){var s;return'\t\t\t\t<div class="sub-cell">'+(null!=(s=(a.monsterNumberWrapper||e&&e.monsterNumberWrapper||a.helperMissing).call(null!=e?e:t.nullContext||{},null!=(s=null!=e?e.formatted:e)?s.fromNumber:s,{name:"monsterNumberWrapper",hash:{},fn:t.program(11,l,0),inverse:t.noop,data:l}))?s:"")+'</div>\n\t\t\t\t<div class="sub-cell">'+t.escapeExpression(t.lambda(null!=(s=null!=e?e.formatted:e)?s.fromName:s,e))+"</div>\n"},11:function(t,e,a,n,l){return""},13:function(t,e,a,n,l){var s;return'\t\t\t\t<div class="sub-cell single-cell">'+(null!=(s=(a.monsterNumberWrapper||e&&e.monsterNumberWrapper||a.helperMissing).call(null!=e?e:t.nullContext||{},null!=(s=null!=e?e.formatted:e)?s.fromNumber:s,{name:"monsterNumberWrapper",hash:{},fn:t.program(11,l,0),inverse:t.noop,data:l}))?s:"")+"</div>\n"},15:function(t,e,a,n,l){var s,r=t.lambda,i=t.escapeExpression;return'\t\t\t\t<div class="sub-cell"><i class="'+i(r(null!=(s=null!=e?e.formatted:e)?s.deviceIcon:s,e))+'" data-placement="top" data-toggle="tooltip" data-original-title="'+i(r(null!=(s=null!=e?e.formatted:e)?s.deviceTooltip:s,e))+'"></i>'+i(r(null!=(s=null!=e?e.formatted:e)?s.fromDeviceName:s,e))+"</div>\n"},17:function(t,e,a,n,l){var s;return'\t\t\t\t<div class="sub-cell">'+(null!=(s=(a.monsterNumberWrapper||e&&e.monsterNumberWrapper||a.helperMissing).call(null!=e?e:t.nullContext||{},null!=(s=null!=e?e.formatted:e)?s.toNumber:s,{name:"monsterNumberWrapper",hash:{},fn:t.program(11,l,0),inverse:t.noop,data:l}))?s:"")+'</div>\n\t\t\t\t<div class="sub-cell">'+t.escapeExpression(t.lambda(null!=(s=null!=e?e.formatted:e)?s.toName:s,e))+"</div>\n"},19:function(t,e,a,n,l){var s;return'\t\t\t\t<div class="sub-cell single-cell">'+(null!=(s=(a.monsterNumberWrapper||e&&e.monsterNumberWrapper||a.helperMissing).call(null!=e?e:t.nullContext||{},null!=(s=null!=e?e.formatted:e)?s.toNumber:s,{name:"monsterNumberWrapper",hash:{},fn:t.program(11,l,0),inverse:t.noop,data:l}))?s:"")+"</div>\n"},21:function(t,e,a,n,l){var s,r=t.lambda,i=t.escapeExpression;return'\t\t\t\t<div class="sub-cell"><i class="'+i(r(null!=(s=null!=e?e.formatted:e)?s.deviceIcon:s,e))+'" data-placement="top" data-toggle="tooltip" data-original-title="'+i(r(null!=(s=null!=e?e.formatted:e)?s.deviceTooltip:s,e))+'"></i>'+i(r(null!=(s=null!=e?e.formatted:e)?s.toDeviceName:s,e))+"</div>\n"},23:function(t,e,a,n,l){var s;return'\t\t\t\t<i data-placement="top" data-toggle="tooltip" data-original-title="'+t.escapeExpression(t.lambda((s=(s=(s=(s=(s=l&&l.root)&&s.i18n)&&s.cdrs)&&s.cdrsList)&&s.table)&&s.interactions,e))+'" class="interactions-cdr fa fa-list-ul"></i>\n'},compiler:[7,">= 4.0.0"],main:function(t,e,a,n,l){var s;return null!=(s=a.each.call(null!=e?e:t.nullContext||{},null!=e?e.cdrs:e,{name:"each",hash:{},fn:t.program(1,l,0),inverse:t.noop,data:l}))?s:""},useData:!0}),this.monster.cache.templates.cdrs._main["cdrs-list-table"]=Handlebars.template({1:function(t,e,a,n,l){var s;return'\t\t\t<a href="#" role="button" class="monster-link download-csv"><i class="fa fa-download monster-green"></i>'+t.escapeExpression(t.lambda(null!=(s=null!=e?e.i18n:e)?s.download:s,e))+"</a>\n"},3:function(t,e,a,n,l){var s,r,i,o='\t\t\t<div class="internal-filter-wrapper">\n\t\t\t\t<span class="filter-title">'+t.escapeExpression(t.lambda(null!=(s=null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.cdrsList:s)?s.table:s)?s.showInternal:s,e))+' (<span class="filter-count"></span>)</span>\n';return r=null!=(r=a.monsterSwitch||(null!=e?e.monsterSwitch:e))?r:a.helperMissing,i={name:"monsterSwitch",hash:{},fn:t.program(4,l,0),inverse:t.noop,data:l},s="function"==typeof r?r.call(null!=e?e:t.nullContext||{},i):r,a.monsterSwitch||(s=a.blockHelperMissing.call(e,s,i)),null!=s&&(o+=s),o+"\t\t\t</div>\n"},4:function(t,e,a,n,l){return'\t\t\t\t\t<input type="checkbox" id="show_internal_cdrs"/>\n'},6:function(t,e,a,n,l){return' id="cdrs_list_legs_table"'},8:function(t,e,a,n,l){return' id="cdrs_list_table"'},compiler:[7,">= 4.0.0"],main:function(t,e,a,n,l){var s,r=null!=e?e:t.nullContext||{},i=t.lambda,o=t.escapeExpression;return'<div class="monster-table-wrapper cdrs-table-container">\n\t<div class="monster-table-header">\n'+(null!=(s=a.unless.call(r,null!=e?e.hideDownload:e,{name:"unless",hash:{},fn:t.program(1,l,0),inverse:t.noop,data:l}))?s:"")+(null!=(s=a.if.call(r,null!=e?e.isLegsTable:e,{name:"if",hash:{},fn:t.program(3,l,0),inverse:t.noop,data:l}))?s:"")+'\t</div>\n\t<div class="table-wrapper">\n\t\t<table class="monster-table footable cdr-list-table"'+(null!=(s=a.if.call(r,null!=e?e.isLegsTable:e,{name:"if",hash:{},fn:t.program(6,l,0),inverse:t.program(8,l,0),data:l}))?s:"")+'>\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th data-type="html">'+o(i(null!=(s=null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.cdrsList:s)?s.table:s)?s.direction:s,e))+'</th>\n\t\t\t\t\t<th data-visible="false">'+o(i(null!=(s=null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.cdrsList:s)?s.table:s)?s.internalCall:s,e))+'</th>\n\t\t\t\t\t<th data-type="html">'+o(i(null!=(s=null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.cdrsList:s)?s.table:s)?s.date:s,e))+'</th>\n\t\t\t\t\t<th data-type="html">'+o(i(null!=(s=null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.cdrsList:s)?s.table:s)?s.from:s,e))+'</th>\n\t\t\t\t\t<th data-type="html">'+o(i(null!=(s=null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.cdrsList:s)?s.table:s)?s.to:s,e))+"</th>\n\t\t\t\t\t<th>"+o(i(null!=(s=null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.cdrsList:s)?s.table:s)?s.duration:s,e))+'</th>\n\t\t\t\t\t<th data-type="html">'+o(i(null!=(s=null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.cdrsList:s)?s.table:s)?s.hangupCause:s,e))+'</th>\n\t\t\t\t\t<th data-type="html">'+o(i(null!=(s=null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.cdrsList:s)?s.table:s)?s.actions:s,e))+"</th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody>\n\n\t\t\t</tbody>\n\t\t</table>\n\t</div>\n</div>"},useData:!0}),this.monster.cache.templates.cdrs._main.layout=Handlebars.template({1:function(t,e,a,n,l){var s,r,i=t.escapeExpression;return'\t\t\t\t\t\t\t\t\t<tr class="user-row" data-id="'+i((r=null!=(r=a.id||(null!=e?e.id:e))?r:a.helperMissing,"function"==typeof r?r.call(null!=e?e:t.nullContext||{},{name:"id",hash:{},data:l}):r))+'">\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t'+i(t.lambda(null!=(s=null!=e?e.formatted:e)?s.friendlyName:s,e))+"\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,a,n,l){var s,r,i=t.lambda,o=t.escapeExpression,d=null!=e?e:t.nullContext||{};return'<div class="cdrs-container">\n\t<div class="action-bar clearfix">\n\t\t<div class="fixed-ranges pull-left">\n\t\t\t<div class="btn-toolbar">\n\t\t\t\t<div class="btn-group">\n\t\t\t\t\t<button data-type="today" class="btn active" type="button">'+o(i(null!=(s=null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.cdrsList:s)?s.dateFilters:s)?s.thisDay:s,e))+'</button>\n\t\t\t\t\t<button data-type="thisWeek" class="btn" type="button">'+o(i(null!=(s=null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.cdrsList:s)?s.dateFilters:s)?s.thisWeek:s,e))+'</button>\n\t\t\t\t\t<button data-type="thisMonth" class="btn" type="button">'+o(i(null!=(s=null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.cdrsList:s)?s.dateFilters:s)?s.thisMonth:s,e))+'</button>\n\t\t\t\t\t<button data-type="custom" class="btn" type="button">'+o(i(null!=(s=null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.cdrsList:s)?s.dateFilters:s)?s.custom:s,e))+'</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="custom-range pull-left">\n\t\t\t<span>'+o(i(null!=(s=null!=e?e.i18n:e)?s.startDate:s,e))+'</span>\n\t\t\t<input id="startDate" type="text" class="date-filter filter-from">\n\t\t\t<span>'+o(i(null!=(s=null!=e?e.i18n:e)?s.endDate:s,e))+'</span>\n\t\t\t<input id="endDate" type="text" class="date-filter filter-to">\n\t\t\t<button type="button" class="apply-filter monster-button monster-button-primary">'+o(i(null!=(s=null!=e?e.i18n:e)?s.filter:s,e))+'</button>\n\t\t</div>\n\n\t\t<div class="pull-left">\n\t\t\t<span class="label-timezone">'+o(i(null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.cdrsList:s)?s.timezoneChoice:s,e))+'</span>\n\t\t\t<select class="logs-timezone" data-original-value="'+o((r=null!=(r=a.currentTimezone||(null!=e?e.currentTimezone:e))?r:a.helperMissing,"function"==typeof r?r.call(d,{name:"currentTimezone",hash:{},data:l
}):r))+'"></select>\n\t\t</div>\n\t</div>\n\n\t<div class="content">\n\t\t<div class="tab-bar">\n\t\t\t<ul class="nav nav-tabs cdrs-tabs">\n\t\t\t\t<li class="tab-overview active"><a href="#cdrs_overall_tab">'+o(i(null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.tabTitles:s)?s.overall:s,e))+'</a></li>\n\t\t\t\t<li class="tab-list"><a href="#cdrs_user_tab">'+o(i(null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.tabTitles:s)?s.user:s,e))+'</a></li>\n\t\t\t</ul>\n\t\t</div>\n\t\t<div class="tab-content">\n\t\t\t<div class="tab-pane active" id="cdrs_overall_tab" data-type="overall">\n\t\t\t\t<div class="link-sub-nav-wrapper">\n\t\t\t\t\t<a class="link-sub-nav active" data-name="dashboard"><i class="fa fa-area-chart"></i>'+o(i(null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.tabTitles:s)?s.dashboard:s,e))+'</a>\n\t\t\t\t\t<a class="link-sub-nav" data-name="logs"><i class="fa fa-file-text-o"></i>'+o(i(null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.tabTitles:s)?s.logs:s,e))+'</a>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="sub-tab-content active" data-type="dashboard">\n\t\t\t\t\tOverall Dashboard\n\t\t\t\t</div>\n\n\t\t\t\t<div class="sub-tab-content" data-type="logs"></div>\n\t\t\t</div>\n\n\t\t\t<div class="tab-pane" id="cdrs_user_tab" data-type="user" data-selected-user="unset">\n\t\t\t\t<div class="user-view select-user-view active">\n\t\t\t\t\t<i class="icon-title icon-telicon-user"></i>\n\t\t\t\t\t<div class="headline">'+o(i(null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.user:s)?s.selectOne:s,e))+'</div>\n\t\t\t\t\t<div class="users-list">\n\t\t\t\t\t\t<table id="cdrs_select_user_table" class="monster-table footable">\n\t\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t<th data-breakpoints="xs">'+o(i(null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.user:s)?s.name:s,e))+"</th>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t<tbody>\n"+(null!=(s=a.each.call(d,null!=e?e.users:e,{name:"each",hash:{},fn:t.program(1,l,0),inverse:t.noop,data:l}))?s:"")+'\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t</table>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="user-view user-selected">\n\t\t\t\t\t<i class="close-user-view icon-telicon-x-circled"></i>\n\t\t\t\t\t<div class="link-sub-nav-wrapper">\n\t\t\t\t\t\t<a class="link-sub-nav active" data-name="dashboard"><i class="fa fa-area-chart"></i>'+o(i(null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.tabTitles:s)?s.dashboard:s,e))+'</a>\n\t\t\t\t\t\t<a class="link-sub-nav" data-name="logs"><i class="fa fa-file-text-o"></i>'+o(i(null!=(s=null!=(s=null!=(s=null!=e?e.i18n:e)?s.cdrs:s)?s.tabTitles:s)?s.logs:s,e))+'</a>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="sub-tab-content active" data-type="dashboard">\n\t\t\t\t\t\tUser Dashboard\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="sub-tab-content" data-type="logs"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n'},useData:!0});